 name t9.c
* Uniflex system calls
ind equ 0 indirect call
indx equ 1 index indirect call
exec equ 2 exec
fork equ 3 fork
wait equ 4 wait
term equ 5 terminate task
break equ 6 exetend memory address
stack equ 7 grow stack
cpint equ 8 catch program interrupt
spint equ 9 send program interrupt
open equ 10 open file
create equ 11 create a file
read equ 12 read file
write equ 13 write file
seek equ 14 seek to file position
close equ 15 close file
dup equ 16 duplicate open file
dups equ 17 duplicate specific file
link equ 18 link to file
unlink equ 19 unlink from file
crtsd equ 20 make special or directory file
chdir equ 21 change directory
lock equ 22 lock task in memory
chown equ 23 change file owner
chprm equ 24 change access perm
chacc equ 25 check access permission
defacc equ 26 set default access
ofstat equ 27 get open file status
status equ 28 get file status
mount equ 29 mount device
unmnt equ 30 unmount device
crpipe equ 31 create pipe
gtid equ 32 get task id
guid equ 33 get user id
suid equ 34 set user id
setpr equ 35 set priority bias
cdata equ 36 request contiguous data
profil equ 37 profile task
trap equ 38 set swi2 trap vector
time equ 39 get time
stime equ 40 set time
ttime equ 41 get task time
update equ 42 update file systems
alarm equ 43 sleep for some seconds
stop equ 44 stop til interrupt
ttyget equ 45 get tty status
ttyset equ 46 set tty status
lrec equ 47 lock file record
urec equ 48 unlock file record
systat equ 49 system status (not public)
sacct equ 50 system accounting
ttynum equ 51 get tty number
filtim equ 52 set file access time
 text
 global _main
_main pshs u,y,x
 leay 4,s
 leas -L2,s
* Auto -6 a
* Auto -8 b
* Auto -10 c
* Auto -210 ar
* Auto -212 p
* Begin expression - 6
 ldd #1
 std -8,y
* Begin expression - 7
 ldd #1
 std [-212,y]
* Begin expression - 8
 ldd #0
 std -10,y
L3
* Begin expression - 8
 ldd -10,y
 cmpd #-5536
  bhs L4
* Begin expression - 9
 ldd -8,y
 std 0,s
 ldd #20
 jsr imul
 leax -210,y
 leax d,x
 ldd [-212,y]
 addd [-212,y]
 lslb
 rola
 ldd d,x
 std -6,y
* Begin expression - 10
 cmpd #0
 beq 10f
 ldd -10,y
 bra 11f
10
 ldd -8,y
11
 std -6,y
* Begin expression - 11
 cmpd #10
 beq 11f
 cmpd #20
 beq 11f
 cmpd #30
 beq 11f
 cmpd #40
 beq 11f
 cmpd #50
10
  bne L6
11
* Begin expression - 12
 ldd #1
 std -8,y
L6
L5
* Begin expression - 13
 inc -9,y
  bne L3
 inc -10,y
  bra L3
L4
L2 equ 212
L1
 leas -4,y
 puls x,y,u,pc
start jsr _main
 ldd #0
 sys term
 end start
