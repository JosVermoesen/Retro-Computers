
*
* parse initializations
*

dcinit clr token eat the "="
 jsr getok get next token
 cmpa #2 is it "{"?
 beq 4f
 jsr bldmat process expression
 rts return
4 clr token eat the {
 bsr inlst process init list
 jsr getok get next token
 cmpa #9 is it ","?
 bne 5f
 clr token eat it
5 jsr getok get next token
 cmpa #3 is it "}"?
 bne 8f
 clr token eat the token
 tsta set true
 rts return
8 clra **** set error *****
 rts

*
* process init list
*

inlst jsr getok get token
 cmpa #3 is it '}'?
 beq 7f
 cmpa #2 is it "{"?
 beq 4f
2 jsr bldmat process expression
 jsr getok get next token
 cmpa #9 is it comma
 bne 7f
 clr token
 jsr getok get next token
 cmpa #3 is it '}'?
 beq 7f
 bra 2b
4 clr token
 bsr inlst process next list
 jsr getok get next token
 cmpa #9 is it ","?
 beq 4b
6 cmpa #3 is it "}"?
 bne 8f
 clr token eat the token
 jsr getok get next token
 cmpa #9 is it ','?
 beq 4b
7 tsta set true
 rts return
8 clra *** set error ***
 rts


