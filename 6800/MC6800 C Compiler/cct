
 ttl Code generation - 7
 pag

*
* Special group VII
*

spclh lda moprtr,y get operator
 cmpa #120 is it dot op?
 beq dotop
 rts ******* temp *******

*
* Process dot operator
*

dotop ldd op1clh get op1 type
 cmpd #STRUCT is it structure or union?
 bne dotopr
 lda op1loc get location
 cmpa #MEMLOC in memory?
 bne dotop4
 ldd stnam check name
 bne dotopr error?
 ldd op1adr get address
 std stnam set name
 clr stref set ref type
 ldd #0 clear offset
 std stoff
dotop4 ldx op2adr point to op 2
 lda sclass,x check class
 cmpa #MOS is it a member?
 beq dotop5
 cmpa #MOU
 bne dotopr
dotop5 ldd sstore,x get offset
 addd stoff add to existing offset
 std stoff save new
 lda matlev set new level
 inca
 sta stcont
 ldd op2clh get result type
 lbra gtcur2
dotopr clra set error
 rts return


