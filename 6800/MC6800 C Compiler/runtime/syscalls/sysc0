* system calls - file 0

 name Syscals0

 text

 ext end_adr

 lib sysdef

* SBRK(incr)

 global _sbrk
_sbrk ldd 2,s incr
 addd end_adr
 pshs d
 ldb #break
 pshs b
 leax 0,s
 sys indx
 leas 1,s
 bes 6f
 puls x
 ldd end_adr
 stx end_adr
 rts
6 std _errno
 leas 2,s
 ldd #-1
 rts

* BRK(addr)

 global _brk

_brk ldd 2,s
 pshs d
 ldb #break
 pshs b
 leax 0,s
 sys indx
 leas 3,s
 bes 2f
 ldd 2,s
 std end_adr
 ldd #0
 rts
2 std _errno
 ldd #-1
 rts

 end
