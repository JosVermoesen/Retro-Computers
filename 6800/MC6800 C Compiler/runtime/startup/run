 name Startup

 text

 ext _main

 lib sysdef

 global _exit,__exit,grows

start ldd #_end
 std end_adr
 tfr s,d
 clrb
 anda #$f0
 std stk_base
 leax 2,s point to args
 ldd 0,s get argc
 pshs d,x set up for main
 jsr _main
44 ldd #0
__exit
_exit clra
 sys term

* grow stack

grows sys stack
 bcs 2f error?
 tfr x,d
 clrb
 anda #$f0
 std stk_base
 rts
2 sys gtid get task id
 sys spint,7 send self signal
 bra 44b

 data
 global end_adr
end_adr fdb 0
 global stk_base
stk_base fdb 0

 text

 end start
