 name flushbuf.c
 text
 global __flushb
__flushb pshs u,y
 leay 2,s
 leas -L2,s
* Auto 5 c
* Begin expression - 0
 ldu 6,y
* Register 128 stream
* Auto -4 i
* Begin expression - 43
 ldd 6,u
 andb #$4
 lbeq L3
* Begin expression - 45
 ldd #0
 std -4,y
* Begin expression - 50
 ldd 6,u
 clrb
 anda #$1
 lbeq L4
 ldd 6,u
 clrb
 anda #$4
10
 lbne L4
* Begin expression - 52
 ldd 8,u
 std 0,s
 jsr _isatty
 addd #0
 lbne L5
* Begin expression - 53
 ldd #2
 std 0,s
 ldd #0
 pshs d
 ldd #0
 pshs d
 ldd 8,u
 pshs d
 jsr _lseek
 leas 6,s
 cmpd #-1
 lbne L6
* Begin expression - 54
 ldd #-1
 std -4,y
L6
L5
L4
* Begin expression - 57
 ldd -4,y
 cmpd #-1
 lbeq L7
* Begin expression - 58
 ldd #1
 std 0,s
 leax 5,y
 pshs x
 ldd 8,u
 pshs d
 jsr _write
 leas 4,s
 cmpd #1
 bne 10f
 ldb 5,y
 clra
 bra 11f
10
 ldd #-1
11
 std -4,y
L7
* Begin expression - 59
 ldd #0
 std 2,u
 lbra L8
L3
* Begin expression - 65
 ldx 4,u
 lbne L9
* Begin expression - 68
 ldd #512
 std 0,s
 jsr _malloc
 tfr d,x
 stx 4,u
 lbne L10
* Begin expression - 71
 ldd 6,u
 orb #$4
 std 6,u
* Begin expression - 72
 ldd #0
 std -4,y
* Begin expression - 77
 ldd 6,u
 clrb
 anda #$1
 lbeq L11
 ldd 6,u
 clrb
 anda #$4
10
 lbne L11
* Begin expression - 79
 ldd 8,u
 std 0,s
 jsr _isatty
 addd #0
 lbne L12
* Begin expression - 80
 ldd #2
 std 0,s
 ldd #0
 pshs d
 ldd #0
 pshs d
 ldd 8,u
 pshs d
 jsr _lseek
 leas 6,s
 cmpd #-1
 lbne L13
* Begin expression - 81
 ldd #-1
 std -4,y
L13
L12
L11
* Begin expression - 83
 ldd -4,y
 cmpd #-1
 lbeq L14
* Begin expression - 84
 ldd #1
 std 0,s
 leax 5,y
 pshs x
 ldd 8,u
 pshs d
 jsr _write
 leas 4,s
 cmpd #1
 bne 10f
 ldb 5,y
 clra
 bra 11f
10
 ldd #-1
11
 std -4,y
L14
* Begin expression - 85
 ldd #0
 std 2,u
 lbra L15
L10
* Begin expression - 90
 ldd #511
 std 2,u
* Begin expression - 91
 ldx 4,u
 stx 0,u
* Begin expression - 92
 ldx 0,u
 leax 1,x
 stx 0,u
 ldd 5,y
 stb -1,x
* Begin expression - 94
 ldd 8,u
 std 0,s
 jsr __termor
 addd #0
 beq 10f
 ldd #64
 bra 11f
10
 ldd #0
11
 orb #$8
 ora 6,u
 orb 7,u
 std 6,u
* Begin expression - 95
 ldb 5,y
 clra
 std -4,y
L15
 lbra L16
L9
* Begin expression - 108
 ldd #0
 std -4,y
* Begin expression - 109
 ldd 6,u
 clrb
 anda #$4
 lbeq L17
* Begin expression - 111
 ldd 6,u
 clrb
 anda #$1
 lbeq L18
* Begin expression - 113
 ldd 8,u
 std 0,s
 jsr _isatty
 addd #0
 lbne L19
* Begin expression - 114
 ldd #2
 std 0,s
 ldd #0
 pshs d
 ldd #0
 pshs d
 ldd 8,u
 pshs d
 jsr _lseek
 leas 6,s
 cmpd #-1
 lbne L20
* Begin expression - 115
 ldd #-1
 std -4,y
L20
L19
L18
* Begin expression - 117
 ldd -4,y
 cmpd #-1
 lbeq L21
* Begin expression - 119
 ldd 2,u
 ble 10f
 ldd 2,u
 bra 11f
10
 ldd #0
11
 nega
 negb
 sbca #0
 addd #512
 std -4,y
* Begin expression - 120
 std 0,s
 ldx 4,u
 pshs x
 ldd 8,u
 pshs d
 jsr _write
 leas 4,s
 cmpd -4,y
 lbeq L22
* Begin expression - 121
 ldd #-1
 std -4,y
 lbra L23
L22
* Begin expression - 125
 ldd #511
 std 2,u
* Begin expression - 126
 ldx 4,u
 stx 0,u
* Begin expression - 127
 ldx 0,u
 leax 1,x
 stx 0,u
 ldd 5,y
 stb -1,x
* Begin expression - 128
 ldb 5,y
 clra
 std -4,y
L23
L21
 lbra L24
L17
* Begin expression - 135
 ldd #511
 std 2,u
* Begin expression - 136
 ldx 4,u
 stx 0,u
* Begin expression - 137
 ldx 0,u
 leax 1,x
 stx 0,u
 ldd 5,y
 stb -1,x
* Begin expression - 138
 ldb 5,y
 clra
 std -4,y
L24
L16
L8
* Begin expression - 143
 ldd -4,y
L1
L2 equ 4
 leas -2,y
 puls y,u,pc
 data
 text
 end
