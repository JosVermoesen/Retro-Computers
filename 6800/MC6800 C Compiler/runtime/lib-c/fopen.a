 name fopen.c
 text
 global _fopen
_fopen pshs u,y
 leay 2,s
 leas -L2,s
* Auto 4 filenam
* Begin expression - 0
 ldu 6,y
* Register 128 mode
* Auto -4 fd
* Auto -6 fp
* Auto -8 type
* Auto -10 open_mo
* Begin expression - 77
 ldb 0,u
 cmpb #114
 lbne L3
* Begin expression - 79
 ldd #1
 std -8,y
* Begin expression - 80
 ldx 0,u
 leax 1,x
 stx 0,u
 ldb 0,x
 cmpb #43
 lbne L4
* Begin expression - 85
 ldd #2
 std -10,y
* Begin expression - 86
 ldd -8,y
 ora #$2
 orb #$2
 std -8,y
 lbra L5
L4
* Begin expression - 88
 ldb 0,u
 lbeq L6
* Begin expression - 93
 ldx #0
 lbra L1
L6
* Begin expression - 97
 ldd #0
 std -10,y
L7
L5
* Begin expression - 100
 ldd -10,y
 std 0,s
 ldx 4,y
 pshs x
 jsr _open
 leas 2,s
 std -4,y
 cmpd #-1
 lbne L8
* Begin expression - 101
 ldx #0
 lbra L1
L8
 lbra L9
L3
* Begin expression - 103
 ldb 0,u
 cmpb #119
 lbne L10
* Begin expression - 105
 ldd #2
 std -8,y
* Begin expression - 106
 ldx 0,u
 leax 1,x
 stx 0,u
 ldb 0,x
 cmpb #43
 lbne L11
* Begin expression - 111
 ldd -8,y
 ora #$2
 orb #$1
 std -8,y
 lbra L12
L11
* Begin expression - 113
 ldb 0,u
 lbeq L13
* Begin expression - 118
 ldx #0
 lbra L1
L13
L12
* Begin expression - 121
 ldd #11
 std 0,s
 ldx 4,y
 pshs x
 jsr _creat
 leas 2,s
 std -4,y
 cmpd #-1
 lbne L14
* Begin expression - 122
 ldx #0
 lbra L1
L14
* Begin expression - 123
 ldd -8,y
 clrb
 anda #$2
 lbeq L15
* Begin expression - 129
 ldd -4,y
 std 0,s
 jsr _close
 tfr d,x
* Begin expression - 130
 ldd #2
 std 0,s
 ldx 4,y
 pshs x
 jsr _open
 leas 2,s
 std -4,y
 cmpd #-1
 lbne L16
* Begin expression - 131
 ldx #0
 lbra L1
L16
L15
 lbra L17
L10
* Begin expression - 134
 ldb 0,u
 cmpb #97
 lbne L18
* Begin expression - 136
 ldd #258
 std -8,y
* Begin expression - 137
 ldx 0,u
 leax 1,x
 stx 0,u
 ldb 0,x
 cmpb #43
 lbne L19
* Begin expression - 142
 ldd -8,y
 ora #$2
 orb #$1
 std -8,y
* Begin expression - 143
 ldd #2
 std -10,y
 lbra L20
L19
* Begin expression - 145
 ldb 0,u
 lbeq L21
* Begin expression - 150
 ldx #0
 lbra L1
L21
* Begin expression - 154
 ldd #1
 std -10,y
L22
L20
* Begin expression - 157
 ldd -10,y
 std 0,s
 ldx 4,y
 pshs x
 jsr _open
 leas 2,s
 std -4,y
 cmpd #-1
 lbne L23
* Begin expression - 159
 ldd #11
 std 0,s
 ldx 4,y
 pshs x
 jsr _creat
 leas 2,s
 std -4,y
 cmpd #-1
 lbne L24
* Begin expression - 160
 ldx #0
 lbra L1
L24
* Begin expression - 161
 ldd -8,y
 clrb
 anda #$2
 lbeq L25
* Begin expression - 167
 ldd -4,y
 std 0,s
 jsr _close
 tfr d,x
* Begin expression - 168
 ldd #2
 std 0,s
 ldx 4,y
 pshs x
 jsr _open
 leas 2,s
 std -4,y
 cmpd #-1
 lbne L26
* Begin expression - 169
 ldx #0
 lbra L1
L26
L25
 lbra L27
L23
* Begin expression - 172
 ldd #2
 std 0,s
 ldd #0
 pshs d
 ldd #0
 pshs d
 ldd -4,y
 pshs d
 jsr _lseek
 leas 6,s
 tfr d,x
L27
 lbra L28
L18
* Begin expression - 180
 ldx #0
 lbra L1
L28
L17
L9
* Begin expression - 188
 jsr __allocf
 tfr d,x
 stx -6,y
 lbne L29
* Begin expression - 189
 ldd -4,y
 std 0,s
 jsr _close
 tfr d,x
 lbra L30
L29
* Begin expression - 190
 ldd -8,y
 std 0,s
 ldd -4,y
 pshs d
 ldx -6,y
 pshs x
 jsr __setupf
 leas 4,s
L30
* Begin expression - 195
 ldx -6,y
L1
L2 equ 10
 tfr x,d
 leas -2,y
 puls y,u,pc
 data
 text
 end
