                      ; ramTest.asm
                      ; Assembled with asm6809
                      ; Land Boards, LLC
                      ; Test RAM using LB-6809-01 on LB-MEM-02 card
                      
0000                  RAMSTART        EQU $0000
0007                  RAMEND          EQU $0007
8000                  RAMENDPL1       EQU $8000
                      
C000                                  ORG $C000
                      ; SET LED = LOW
C000  12              RESVEC  NOP
C001  CE7FFE                          LDU     #$7FFE  ; SET USER STACK POINTER
                      ; TEST WITH WRTE/READ OF ADDRESS $0000 AND VALUE OF $55
C004  8655                            LDA     #$55
C006  B70000                          STA     RAMSTART
C009  12                              NOP
C00A  F60000                          LDB     RAMSTART
C00D  C155                            CMPB #$55
C00F  265F                            BNE     FASTBLINK
                      ; TEST WITH WRTE/READ OF ADDRESS $0000 AND VALUE OF $AA
C011  86AA                            LDA     #$AA
C013  B70000                          STA     RAMSTART
C016  12                              NOP
C017  F60000                          LDB     RAMSTART
C01A  C1AA                            CMPB #$AA
C01C  2652                            BNE     FASTBLINK
                      ; BOUNCE A BIT ACROSS THE DATA LINES OF ADDR $0000
C01E  8601                            LDA #$01
C020                  LOOP1ADR
C020  B70000                          STA RAMSTART
C023  12                              NOP
C024  B10000                          CMPA RAMSTART
C027  2647                            BNE     FASTBLINK
C029  48                              ASLA
C02A  8100                            CMPA #$00
C02C  26F2                            BNE     LOOP1ADR
                      ; Fill memory with a ramp value
C02E  8E0000                          LDX #RAMSTART
C031  8600                            LDA #0
C033  C601                            LDB #1
C035                  LPSTORE
C035  A784                            STA 0,X
C037  3A                              ABX
C038  4C                              INCA
C039  8C8000                          CMPX    #RAMENDPL1
C03C  26F7                            BNE     LPSTORE
                      ; CHECK RAMP VALUES
C03E  8E0000                          LDX #RAMSTART
C041  8600                            LDA #0
C043  C601                            LDB #1
C045                  LPCHECK
C045  A184                            CMPA    0,X
C047  2627                            BNE     FASTBLINK
C049  3A                              ABX
C04A  4C                              INCA
C04B  8C8000                          CMPX    #RAMENDPL1
C04E  26F5                            BNE     LPCHECK
                      ;
                      ; CHECK UPPER ADDRESS LINES
                      ;
C050  8601                            LDA     #1                      ; UPPER BYTE OF D
C052  C600                            LDB     #0                      ; LOWER BYTE OF D
C054                  LOOPBITWR
C054  1F01                            TFR     D,X
C056  A784                            STA     0,X
C058  8B01                            ADDA    #1
C05A  8150                            CMPA    #80
C05C  26F6                            BNE             LOOPBITWR
                      ; 
C05E  8601                            LDA     #1                      ; UPPER BYTE OF D
C060  C600                            LDB     #0                      ; LOWER BYTE OF D
C062                  LOOPBITRD
C062  1F01                            TFR     D,X
C064  A184                            CMPA    0,X
C066  2608                            BNE     FASTBLINK
C068  8B01                            ADDA    #1
C06A  8150                            CMPA    #80
C06C  26F4                            BNE             LOOPBITRD
                                      
                                      
                      ; DEFAULT = PASS
C06E  2021                            BRA     SLOWBLINK
                      
                      ;
                      ; Slowly blink LED
                      ;
C070                  FASTBLINK
C070  4F                              CLRA
C071  B7F000                          STA     $F000
                      ; WAIT LOOP
C074  8640                            LDA     #$40
C076                  LOOPX1
C076  C6FF                            LDB     #$FF
C078                  LOOPX1B
C078  12                              NOP
C079  5A                              DECB
C07A  26FC                            BNE LOOPX1B
C07C  4A                              DECA
C07D  26F7                            BNE     LOOPX1
                      ; SET LED = HIGH
C07F  8601                            LDA     #$1
C081  B7F000                          STA     $F000
                      ; WAIT LOOP
C084  86FF                            LDA     #$FF
C086                  LOOPX2
C086  C640                            LDB     #$40
C088                  LOOPX2B
C088  12                              NOP
C089  5A                              DECB
C08A  26FC                            BNE LOOPX2B
C08C  4A                              DECA
C08D  26F7                            BNE     LOOPX2
                      ; LOOP FOREVER
C08F  20DF                            BRA     FASTBLINK
                      
                      ;
                      ; Slowly blink LED
                      ;
C091                  SLOWBLINK
C091  4F                              CLRA
C092  B7F000                          STA     $F000
                      ; WAIT LOOP
C095  86FF                            LDA     #$FF
C097                  LOOP1
C097  C6FF                            LDB     #$FF
C099                  LOOP1B
C099  12                              NOP
C09A  5A                              DECB
C09B  26FC                            BNE LOOP1B
C09D  4A                              DECA
C09E  26F7                            BNE     LOOP1
                      ; SET LED = HIGH
C0A0  8601                            LDA     #$1
C0A2  B7F000                          STA     $F000
                      ; WAIT LOOP
C0A5  86FF                            LDA     #$FF
C0A7                  LOOP2
C0A7  C6FF                            LDB     #$FF
C0A9                  LOOP2B
C0A9  12                              NOP
C0AA  5A                              DECB
C0AB  26FC                            BNE LOOP2B
C0AD  4A                              DECA
C0AE  26F7                            BNE     LOOP2
                      ; LOOP FOREVER
C0B0  20DF                            BRA     SLOWBLINK
                      
                      ; Reset vector
FFFE                                  ORG     $FFFE
FFFE  C000            LBFFE   FDB     RESVEC  ; RESET 
