
REM PIN BALL

 10 REM   PINBALL
 15 REM COPYRIGHT 1982          ALAN STANKIEWICZ
 20 FORJ=1TO30:PRINT:NEXT
 24 POKE546,1:POKE56900,0
 25 KW=57088
 26 A=53508
 30 POKEA+1622,49
 31 B=32:BB=188:BA=1
 32 C=57100:Z=55232
 33 D=5:E=3:F=7
 34 G=A+1483:H=A+1484:I=A+1485:M=A+1419:N=A+1356:O=A+1548
 35 P=A+1490:Q=A+1489:R=A+1488:S=A+1553:T=A+1426:U=A+1361
 36 V=135:W=189:X=190
 37 DI=-1:LC=A+85:Y=111
 38 POKEA+88,96:POKEA+217,96
 39 POKEA+1482,96:POKEA+1547,96:POKEA+1491,96:POKEA+1554,96
 40 FORJ=0TO25:POKEJ*64+A,90-J:NEXT
 44 FORJ=0TO25
 45 POKEA+1+J*64,32:POKEA+2+J*64,32:POKEA+3+J*64,32:POKEA+4+J*64,32
 46 NEXT
 50 FORJ=0TO15:POKEJ+A+6,131:NEXT
 52 FORJ=0TO24:POKEA+69+J*64,140:NEXT
 54 FORJ=0TO21:POKEA+281+J*64,136:NEXT
 56 FORJ=0TO19:POKEA+408+J*64,136:NEXT
 60 DATA5,221,22,198,38,235,54,209,55,190,88,200,104,233,107,233
 62 DATA110,233,113,233,116,233,120,199,134,178,166,233,198,175
 68 DATA204,189,205,135,206,135,207,135,208,135,209,190,232,233,233,233
 70 DATA236,233,237,161,238,161,239,161,240,161,241,233,244,233,245,233
 72 DATA264,233,265,233,268,233,269,161,270,161,271,161,272,161,273,233
 74 DATA276,233,277,233,300,190,301,128,302,128,303,128,304,128,305,189
 76 DATA326,178,343,176,358,233,375,233,390,175,407,177,425,234,426,235
 78 DATA435,234,436,235,518,233,535,233,647,161,648,178,661,176,662,161
 80 DATA679,161,680,161,681,178,692,176,693,161,694,161,711,161,712,161
 82 DATA713,161,714,178,723,176,724,161,725,161,726,161,747,190,754,189
 84 DATA780,190,785,189,818,66,819,65,820,76,821,76
 90 FORJ=1TO85:READK,L:K1=INT(K/32):H1=K-K1*32:POKEA+K1*64+H1,L:NEXT
 92 POKEA+526,71
 93 J=PEEK(546)
 94 POKEA+527,J+48
 100 IFBA>5THEN1000
 102 POKEH,B:POKEI,B:POKEM,B:POKEN,B:POKEA+1420,B:POKEG,X:POKEO,X
 104 POKEQ,B:POKER,B:POKET,B:POKEU,B:POKEA+1425,B:POKEP,W:POKES,W
 110 POKE530,0:POKE530,1
 120 POKEKW,2:IFPEEK(KW)=16THENPOKE530,0:GOTO140
 130 GOTO110
 140 POKEA+1622,BA+48
 150 FORJ=1TO19
 155 POKEA+1688-64*J,Y
 160 POKEA+1688-64*J,136
 170 NEXT
 175 POKEA+215,Y:POKEA+215-65,Y
 176 FORJ=1TO50:NEXT
 177 POKEA+215,B:POKEA+215-65,B
 200 IFPEEK(C)=DORPEEK(C)=FTHENGOSUB400:GOTO220
 210 IFPEEK(G)=VTHENPOKEH,B:POKEI,B:POKEG,X:POKEO,X
 215 IFPEEK(M)=WTHENPOKEN,B:POKEM,B:POKEG,X:POKEO,X:POKEA+1420,B
 220 IFPEEK(C)=EORPEEK(C)=FTHENGOSUB500:GOTO240
 230 IFPEEK(P)=VTHENPOKEQ,B:POKER,B:POKEP,W:POKES,W
 235 IFPEEK(T)=XTHENPOKEU,B:POKET,B:POKEP,W:POKES,W:POKEA+1425,B
 240 IFPEEK(LC+DI)<>BTHENGOSUB600:GOTO240
 250 POKELC,B:POKELC+DI,Y:LC=LC+DI
 260 IFLC>ZTHENPOKELC,B:LC=A+85:DI=-1:BA=BA+1:GOTO100
 390 GOTO200
 400 IFPEEK(M)=WTHENRETURN
 403 IFPEEK(G)=VTHEN430
 405 IFPEEK(H)<>BORPEEK(I)<>BTHENRETURN
 410 POKEO,B
 420 POKEG,V:POKEH,V:POKEI,V
 425 RETURN
 430 IFPEEK(M)<>BORPEEK(N)<>BTHENRETURN
 433 POKEG,B:POKEH,B:POKEI,B
 435 POKEM,W:POKEN,W:POKEA+1420,96
 440 RETURN
 500 IFPEEK(T)=XTHENRETURN
 503 IFPEEK(P)=VTHEN530
 505 IFPEEK(Q)<>BORPEEK(R)<>BTHENRETURN
 510 POKES,B
 520 POKEP,V:POKEQ,V:POKER,V
 525 RETURN
 530 IFPEEK(T)<>BORPEEK(U)<>BTHENRETURN
 533 POKEP,B:POKEQ,B:POKER,B
 535 POKET,X:POKEU,X:POKEA+1425,96
 550 RETURN
 600 IFPEEK(LC+DI)=233THENPOKELC+DI,161:GOSUB700:POKELC+DI,233
 605 ONINT(RND(8)*8+1)GOTO610,620,630,640,650,660,670,680
 610 DI=1:RETURN
 620 DI=65:RETURN
 630 DI=64:RETURN
 640 DI=63:RETURN
 650 DI=-1:RETURN
 660 DI=-65:RETURN
 670 DI=-64:RETURN
 680 DI=-63:RETURN
 700 SP=SP+1
 707 IFSP>27THENPOKELC,B:J=PEEK(546):POKE546,J+1:RUN25
 715 K=A+1729-SP*64
 716 POKEK,161:POKEK+1,161:POKEK+2,161:POKEK+3,161
 770 FORJ=1TO5:POKEKW,223:NEXT
 780 RETURN
 1000 POKE530,0:POKE530,1
 1010 POKEKW,64:IFPEEK(KW)=4THENPOKE530,0:RUN24
 1020 GOTO1000
