
REM Tiny Compiler from Aardvark...............

 5 REM SCREEN SHIFTER -7999:COMPILER STARTS AT 9000
 10 T=53248:B=55167:A=1
 20 R=T:Q=PEEK(R):POKEB,Q
 25 Z=R+1:Q=PEEK(Z):POKE R,Q
 30 R=R+1:IFR<BTHEN GOTO 25
 40 GOTO 20
 7999 END
 8000 POKEM,P:M=M+1:RETURN
 8005 P=PEEK(Q):Q=Q+1:IFP=32THEN8005
 8010 IFP=0THENC=2
 8015 RETURN
 8020 IFP<65ORP>90THEN8030
 8025 RETURN
 8030 PRINT:PRINT"ERROR LINE# ";L$(L):END
 8035 IFP<48ORP>57THENRETURN
 8040 C$=C$+CHR$(P):GOSUB8005:GOTO8035
 8045 C$="":GOSUB8035:IFC$=""THENF=-1:RETURN
 8050 F=VAL(C$)
 8055 MB=INT(F/256):LB=F-MB*256:RETURN
 8060 GOSUB8235:GOSUB8085:GOSUB8185:GOSUB8225:GOSUB8090:GOSUB8185
 8061 RETURN
 8070 GOSUB8210:P=LB:GOSUB8000:GOSUB8215:P=MB:GOSUB8000:RETURN
 8075 P=160:GOSUB8000:RETURN
 8080 GOSUB8235:GOSUB8170:GOSUB8085:GOSUB8220:GOSUB8170:RETURN
 8085 P=200:GOSUB8000:RETURN
 8090 P=136:GOSUB8000:RETURN
 8095 P=121:IFS=164THENP=249:GOTO8110
 8100 IFS=168THENP=57:GOTO8110
 8105 IFS=169THENP=25
 8110 GOSUB8245:RETURN
 8115 P=24:IFS=164THENP=56
 8120 GOSUB8000:RETURN
 8125 P=96:GOSUB8000:RETURN
 8130 P=16:GOSUB8000:RETURN
 8135 F=(V4-64)*2+ZZ+256*XX:GOSUB8055:GOSUB8140:RETURN
 8140 P=46:GOSEB8240:RETURN
 8145 P=10:GOSUB8000:RETURN
 8150 P=72:GOSUB8000:RETURN
 8155 P=104:GOSUB8000:RETURN
 8160 P=202:GOSUB8000:RETURN
 8165 P=153:GOSUB8000:RETURN
 8170 P=153:GOSUB8245:RETURN
 8175 P=240:GOSUB8000:RETURN
 8180 P=LB:GOSUB8000:P=MB:GOSUB8000:RETURN
 8185 P=185:GOSUB8245:RETURN
 8190 P=185:GOSUB8000:RETURN
 8195 P=144:GOSUB8000:RETURN
 8200 P=176:GOSUB8000:RETURN
 8205 P=208:GOSUB8000:RETURN
 8210 P=169:GOSUB8000:RETURN
 8215 P=162:GOSUB8000:RETURN
 8220 P=138:GOSUB8000:RETURN
 8225 P=170:GOSUB8000:RETURN
 8230 P=217:GOSUB8245:RETURN
 8235 GOSUB8075:P=(V1-64)*2:GOSUB8000:RETURN
 8240 GOSUB8000:P=LB:GOSUB8000:P=MB:GOSUB8000:RETURN
 8245 GOSUB8000:P=ZZ:GOSUB8000:P=XX:GOSUB8000:RETURN
 8250 P=0:GOSUB8000:GOSUB8000:RETURN
 9000 DIML$(50),L3$(50)
 9005 FORI=0TO32:PRINT:NEXT:PRINT"TINY COMPILER  1.1":PRINT:PRINT
 9010 X=PEEK(127)+256*PEEK(128)-5:PRINT"TOP OF BASIC PROGRAM=":PRINTX
 9015 Q=769:L=1:PRINT:PRINT"FOR DEFAULT ENTER '0'":PRINT
 9016 V9=PEEK(127)+PEEK(128)*256+1000
 9020 PRINT"DESIRED LOC(DECIMAL) OF OBJ CODE("V9"DEFAULT)";:INPUTM
 9025 IFM=0THENM=V9
 9030 MM=M:VT=560
 9035 J=0:N=1:L=0:L3$(1)="0":R=0
 9040 INPUT"RELOCATE OBJECT CODE";C$:IFASC(C$)<>89THEN9050
 9045 INPUT"DECIMAL ADDRESS";R:R=R-M
 9050 F=VT:GOSUB8055:XX=MB:ZZ=LB
 9055 M1=PEEK(Q)+256*PEEK(Q+1):X=PEEK(Q+2)+PEEK(Q+3)*256
 9060 PRINT:PRINT"LINE ";X:L=L+1:Q=Q+4
 9064 C$=STR$(X):Y=LEN(C$)-1
 9065 L$(L)=RIGHT$(C$,Y)+STR$(M):IFX>7999THEN9155
 9070 C=0:GOSUB8005:IFC=2THEN9070
 9075 IFP>64ANDP<91THENGOSUB9220:GOTO9145
 9080 IFP=135THENGOSUB8005:GOSUB9220:GOTO9145
 9090 IFP=136THENX=76:GOSUB9540
 9095 IFP=138THENGOSUB9435
 9100 IFP=140THENX=32:GOSUB9540
 9105 IFP=141THENGOSUB8125
 9110 IFP=143THENGOSUB8125
 9115 IFP=129THENJ=J+1:GOSUB9600
 9120 IFP=130THENGOSUB9630:J=J-1
 9125 IFP=150THENGOSUB9550
 9130 IFP=128THENGOSUB8125:GOTO9155
 9135 IFP=142THENQ=M1:GOTO9055
 9140 GOSUB8005
 9145 IFPEEK(Q-1)=58THEN9070
 9150 Q=M1:GOTO9055
 9155 C=VAL(L3$(1)):PRINT:PRINT"JUMP VECTORS":IFC<1THEN9190
 9160 N=N-1:FORY=1TON:C=VAL(L3$(Y)):XX=PEEK(C)+256*PEEK(C+1):ZZ=0
 9165 FORX=1TOL:S=LEN(L$(X)):FORJ=1TOS:IFMID$(L$(X),J,1)<>" "THEN9168
 9166 V2=VAL(RIGHT$(L$(X),S-J)):V1=VAL(LEFT$(L$(X),J-1)):GOTO9170
 9168 NEXT:GOTO9175
 9170 IFXX=V1THENZZ=V2+R:PRINT"JUMPTO";V1;"ADDR=";ZZ
 9175 NEXT:IFZZ=0THENPRINT"NO ADDR FOR ";XX:GOTO9185
 9180 MB=INT(ZZ/256):LB=ZZ-MB*256:POKEC,LB:POKEC+1,MB
 9185 NEXT
 9190 PRINT(M-MM)/256;"PAGES, TOP =";M:PRINT:PRINT"<SHIFT> TO RUN,
 9191 PRINT"CTRL C TO EXIT
 9195 X=PEEK(57100):IFX=254ORX=1THEN9195
 9200 FORX=VTTOVT+54:POKEX,0:NEXT
 9205 PRINT"RUNNING":X=INT(MM/256):Y=MM-X*256:POKE12,X:POKE11,Y
 9210 X=USR(X):FORX=2TO54STEP2:M=VT+X:Y=PEEK(M):Q=PEEK(M+1)
 9215 PRINTCHR$(X/2+64);Y+256*Q:NEXT:STOP
 9220 GOSUB8020:V1=P:GOSUB8005:IFP<>171THEN8030
 9225 GOSUB8005:IFP=187THEN9295
 9230 IFP=176THEN9520
 9235 GOSUB8045:IFF=-1THEN9245
 9240 GOSUB8070:GOSUB8080:RETURN
 9245 V2=P:V4=V1:GOSUB8005:IFP<163ORP>172THENQ=Q-1:GOTO9290
 9250 S=P:GOSUB8005:GOSUB8045:V3=P:IFS=165THEN9335
 9255 IFS=166THEN9385
 9260 IFF=-1THENV8=P:GOTO9270
 9265 V8=64:GOSUB8070:V1=V8:GOSUB8080:Q=Q-1
 9270 V1=V2:GOSUB8060:V1=V8:V2=V8:GOSUB8235:GOSUB8115:GOSUB8095
 9275 V1=V4:GOSUB8235:GOSUB8170:GOSUB8220
 9280 V1=V2:GOSUB8235:GOSUB8085:GOSUB8095
 9285 V1=V4:GOSUB8235:GOSUB8085:GOSUB8170:GOSUB8005:RETURN
 9290 V1=V2:GOSUB8060:V1=V4:GOSUB8080:GOSUB8005:RETURN
 9295 GOSUB8005:IFP<>40THEN8030
 9300 GOSUB8005:GOSUB8045:V4=V1:V1=P:IFF=-1THEN9315
 9305 GOSUB8075:P=0:GOSUB8000:GOSUB8190:GOSUB8180:GOSUB8215
 9310 P=0:GOSUB8000:V1=V4:GOSUB8080:GOSUB8005:RETURN
 9315 GOSUB8005:IFP<>41THEN8030
 9320 X=10:GOSUB9580
 9325 GOSUB8075:P=0:GOSUB8000:GOSUB8190:GOSUB8250
 9330 GOSUB8215:P=0:GOSUB8000:V1=V4:GOSUB8080:GOSUB8005:RETURN
 9335 S=163:V1=V2:GOSUB8060:GOSUB8150
 9340 IFF=-1THENV1=V3:GOSUB8060:V1=64:GOSUB8080:GOSUB8005:GOTO9350
 9345 GOSUB8070:V1=64:GOSUB8080
 9350 F=0:GOSUB8055:GOSUB8070:V1=V4:GOSUB8080:GOSUB8155:GOSUB8215:P=8
 9351 GOSUB8000
 9355 P=24:GOSUB8000:GOSUB8135
 9360 F=F+1:GOSUB8055:GOSUB8140:GOSUB8145:GOSUB8195:P=33:GOSUB8000
 9365 GOSUB8150:V1=V4:GOSUB8235:P=185:GOSUB8245:P=24:GOSUB8000
 9370 GOSUB8075:P=0:GOSUB8000:GOSUB8095:V1=V4:GOSUB8235:GOSUB8170
 9375 GOSUB8085:GOSUB8185:GOSUB8075:P=1:GOSUB8000:GOSUB8095:V1=V4
 9376 GOSUB8235
 9380 GOSUB8085:GOSUB8170:GOSUB8155:GOSUB8160:GOSUB8205:P=210:GOSUB8000
 9381 RETURN
 9385 S=164:IFF=-1THENV1=V3:GOSUB8060:GOSUB8005:GOTO9395
 9390 GOSUB8070
 9395 GOSUB8225:GOSUB8210:P=0:GOSUB8000:V1=64:GOSUB8080
 9400 V1=V2:GOSUB8060:V1=V4:GOSUB8080:GOSUB8215:P=17:GOSUB8000
 9405 F=M+R+15:GOSUB8055:P=76:GOSUB8240:GOSUB8075:P=0:GOSUB8000
 9410 GOSUB8185:GOSUB8115:GOSUB8085:GOSUB8095:GOSUB8130:P=4:GOSUB8000
 9415 P=24:GOSUB8000:F=M+R+9:GOSUB8055:P=76:GOSUB8240:GOSUB8075
 9420 P=0:GOSUB8000:GOSUB8170:GOSUB8115:GOSUB8135:F=F+1:GOSUB8055
 9421 GOSUB8140
 9425 GOSUB8160:GOSUB8175:P=6:GOSUB8000:P=46:GOSUB8245:F=M+R-34
 9426 GOSUB8055
 9430 P=76:GOSUB8240:RETURN
 9435 GOSUB8005:GOSUB8020:V1=P:GOSUB8005:IFP>172ORP<171THEN8030
 9440 V4=P:IFP=172THENGOSUB8005:IFP<>170THEN9480
 9445 GOSUB8005:GOSUB8020:V2=P:GOSUB8060:V1=V2:GOSUB8235:GOSUB8230
 9446 GOSUB8205
 9450 GOSUB9500
 9455 P=7:IFV4=171THENP=10
 9460 GOSUB8000:GOSUB8220:GOSUB8085:GOSUB8230
 9465 IFV4=172THENGOSUB8175:GOTO9475
 9470 GOSUB8205
 9475 P=3:GOSUB8000:GOTO9540
 9480 GOSUB8020:V2=P:GOSUB8235:GOSUB8185:GOSUB8225:GOSUB8085
 9485 GOSUB9500:GOSUB8185:V1=V2:GOSUB8235:GOSUB8085:GOSUB8230:GOSUB8195
 9486 P=11
 9490 GOSUB8000:GOSUB8205:P=12:GOSUB8000:GOSUB8220:GOSUB8090:GOSUB8230
 9495 GOSUB8175:P=5:GOSUB8000:GOSUB8200:P=3:GOSUB8000:GOTO9540
 9500 GOSUB8005:IFP<>160THEN8030
 9505 GOSUB8005:IFP<>136ANDP<>140THEN8030
 9510 X=76:IFP=140THENX=32
 9515 RETURN
 9520 GOSUB8005:GOSUB8005:GOSUB8005:IFP<>41THEN8030
 9525 GOSUB8005:GOSUB8075:P=1:GOSUB8000:GOSUB8190:F=8955:GOSUB8055
 9526 GOSUB8180
 9530 GOSUB8225:GOSUB8090:GOSUB8190:GOSUB8180:X=8:GOSUB9585:P=32
 9531 GOSUB8000
 9535 GOSUB8250:RETURN
 9540 GOSUB8005:GOSUB8045:IFF<1ORF>7999THEN8030
 9545 P=X:GOSUB8000:L3$(N)=STR$(M):N=N+1:GOSUB8180:Q=Q-1:RETURN
 9550 GOSUB8005:GOSUB8020:V1=P:GOSUB8005:IFP<>44THEN8030
 9555 GOSUB8005:GOSUB8045:IFF=-1THEN9570
 9560 V4=LB:X=14:GOSUB9580:GOSUB8075:P=0:GOSUB8000
 9565 LB=V4:MB=0:GOSUB8070:GOSUB8165:GOSUB8250:Q=Q-1:RETURN
 9570 X=21:V2=P:GOSUB9580:V1=V2:GOSUB8060:GOSUB8075:P=0:GOSUB8000
 9571 GOSUB8165
 9575 GOTO8250
 9580 GOSUB8060
 9585 GOSUB8075:P=0:GOSUB8000:GOSUB8165:F=M+X+R:GOSUB8055
 9590 GOSUB8180:GOSUB8085:GOSUB8220:GOSUB8165:GOSUB8180
 9595 RETURN
 9600 GOSUB8005:V7(J)=P:GOSUB9220:Q=Q-1:GOSUB8005:IFP<>157THEN8030
 9605 V6(J)=M-1:GOSUB8005:V5(J)=P:GOSUB8005:T(J)=1:V4=163
 9610 IFP<>162THENQ=Q-1:RETURN
 9615 GOSUB8005:IFP=164THENV4=P:GOSUB8005
 9620 GOSUB8045:T(J)=F:Q=Q-1:IFV4=164THENT(J)=65536-T(J)
 9625 RETURN
 9630 GOSUB8005:IFP<65ORP>90THENQ=Q-1
 9635 V1=V7(J):GOSUB8060:V1=V5(J):GOSUB8235:GOSUB8230:GOSUB8205
 9640 P=10:GOSUB8000:GOSUB8220:GOSUB8085:GOSUB8230
 9645 GOSUB8205:P=3:GOSUB8000:P=76:GOSUB8000:F=M+26+R:GOSUB8055
 9650 GOSUB8180:F=T(J):GOSUB8055:GOSUB8070:S=163
 9655 V1=V7(J):GOSUB8235:GOSUB8115:GOSUB8095:GOSUB8170:GOSUB8220
 9656 GOSUB8085
 9660 GOSUB8095:GOSUB8170:P=76:GOSUB8000:F=V6(J)+1+R:GOSUB8055
 9661 GOSUB8180
 9665 RETURN
