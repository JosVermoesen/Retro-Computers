
REM MINEFIELD N........(Uses joystick)

 1 REM  Mine Field.........
 2 REM
 5 GOSUB4000
 10 FORQ=0TO18:READC:POKE630+Q,C:NEXT
 12 POKE11,118:POKE12,2
 15 DATA169,206,133,255,162,11,169,32,145,254,136,208,251,230
 17 DATA255,202,208,246,96
 18 C=53509
 19 W=22
 20 H=22
 25 BR=.6
 30 MR=.1
 31 TT=450
 32 FORQ=0TO7:READA(Q):NEXT
 33 DATA1,64,-1,-64,-65,65,63,-63
 35 B=58
 40 M=94
 45 G=161
 50 I=64
 55 FORQ=1TO4:READG(Q):NEXT
 60 DATA16,18,20,22
 65 FORQ=1TO4:READI(Q):NEXT
 70 DATA-64,1,64,-1
 75 MG=42
 77 R(0)=128:R(1)=2:K=57088
 80 NM=2
 85 BP=1
 90 MP=5
 100 GP=15
 105 SE(0)=C-128+10
 110 SE(1)=C-128+20
 120 DIMLM(100)
 149 FORQ=0TO1
 150 POKEP(E),G(E)
 151 NEXT
 498 TT=600:F(0)=0:F(1)=0
 499 VD=VD+1:IFVD>1THEN20000
 500 X=USR(X):POKE56900,0
 520 FORQ=CTOC+W:POKEQ,G:POKEQ+H*I,G:NEXTQ
 530 FORQ=CTOC+H*ISTEPI:POKEQ,G:POKEQ+W,G:NEXTQ
 540 FORQ=1TOW-1
 550 FORR=1TOH-1
 560 L=C+Q+R*I
 570 N=RND(8)
 580 IFN>BRTHENPOKEL,B
 590 IF N<MR THEN POKEL,M
 600 NEXTR:NEXTQ
 610 PP(0)=C+66+I*INT(RND(8)*(H-1))
 620 PP(1)=C+66+W-6+Y*INT(RND(8)*(H-1))
 625 D(0)=1:D(1)=1
 630 P(0)=PP(0)
 640 P(1)=PP(1)
 645 POKEP(0),G(D(0)):POKEP(1),G(D(1))
 647 PRINTCHR$(13)S(0)" GET SET "S(1);
 650 FORQ=1TO5000:NEXT
 690 TT=TT-1:IFTT=0THEN498
 695 PRINTCHR$(13)S(0)" <"TT">  "S(1);
 697 F=E
 699 E=E+1:IFE>1THENE=0
 700 D=0
 710 POKE530,0:POKE530,1:POKEK,128
 715 J=PEEK(K):GOSUB4100
 720 IFDRTHEND=INT((DR+1)/2)
 758 IFF(E)THEN1010
 759 F(E)=FI:IFFITHEN1000
 775 IFD=0THEN690
 780 IFD<>D(E)THEND(E)=D:GOTO800
 790 IFPEEK(P(E)+I(D))<>32THEN810
 795 POKEP(E),32
 797 P(E)=P(E)+I(D)
 800 POKEP(E),G(D)
 810 GOTO690
 1000 MI(E)=I(D(E)):MP(E)=P(E)+MI(E):V=PEEK(MP(E))
 1002 IFV<>32THENF(E)=0:GOTO1040
 1005 POKEMP(E),MG
 1010 FORQ=1TONM:POKEMP(E),32
 1020 MP(E)=MP(E)+MI(E):V=PEEK(MP(E)):IFV<>32THENF(E)=0:Q=NM:GOTO1040
 1025 POKEMP(E),MG
 1030 NEXTQ
 1035 GOTO775
 1040 IFV=GTHEN775
 1045 POKEMP(E),32
 1050 IFV=BTHENS(E)=S(E)+BP:GOTO775
 1060 IFV=MTHENS(E)=S(E)+MP:GOTO2000
 1080 IFV=MGTHENF(F)=0
 1090 IFV=G(D(F))THENP(F)=PP(F):S(E)=S(E)+GP:POKEP(F),G(D(F))
 1100 POKEMP(E),32
 1299 GOTO775
 2000 MC=1:MO=1
 2010 LM(MC)=MP(E)
 2020 FORQ=0TO7
 2030 X=LM(MO)+A(Q):V=PEEK(X)
 2040 IFV=32ORV=GORV=MGTHEN2200
 2045 IFV=MGTHEN2150
 2050 IFV=MTHENS(E)=S(E)+MP:MC=MC+1:LM(MC)=X:GOTO2150
 2060 IFV=BTHENS(E)=S(E)+BP:GOTO2150
 2075 IFX=P(E)THEN2100
 2080 P(F)=PP(F):POKEP(F),G(D(F))
 2090 S(E)=S(E)+GP
 2095 GOTO2150
 2100 P(E)=PP(E):POKEP(E),G(D(F))
 2110 S(F)=S(F)+GP
 2150 FORZ=1TO5
 2160 POKEX,232.5+RND(8)
 2164 NEXTZ
 2170 POKEX,32
 2200 NEXTQ
 2210 MO=MO+1
 2220 IFMO>MCTHEN775
 2230 GOTO2020
 3999 STOP
 4000 DATAKEYBOARD
 4005 READA$:IFA$<>"KEYBOARD"THEN4005
 4006 DIMKE(16),DI(16),FI(16)
 4010 FORQ=0TO16:READKE(Q),DI(Q),FI(Q):NEXT
 4012 FORQ=1TO8:READM(Q):NEXT
 4015 RESTORE:RETURN
 4020 RETURN
 4030 DATA8,0,1,64,5,0,128,1,0,16,3,0,32,7,0
 4040 DATA18,5,1,221,1,1,189,3,1,125,7,1
 4050 DATA175,4,0,159,8,0,95,2,0,111,6,0
 4060 DATA173,4,1,157,8,1,93,2,1,109,6,1
 4070 DATA -64,-65,1,65,64,63,-1,-63
 4100 DR=0:FI=0:FORQ=0TO5:IFJ=KE(Q)THENDR=DI(Q):FI=FI(Q):Q=17
 4110 NEXT:RETURN
 20000 PRINT:PRINT"TOTAL SCORE ="S(1)+S(0)"!":FORJ=1TO3000:NEXT
 20001 POKE530,0
