
REM ASTEROID ALIEN (It really works)

 5 REM ASTEROID ALIEN by Mark Spankus (never really finished)
 25 FORT=1TO10:PRINT:PRINT:PRINT:NEXT
 50 FORT=1TO100:POKEINT(RND(8)*1720)+53440,46:NEXT
 75 FORT=1TO4:FORY=1TO3:READP(T,Y):NEXTY,T:FORT=3TO6:READA(T):NEXT
 76 A9=6:E3=46
 100 X=INT(RND(9)*1720)+53440:J=INT(RND(X)*1720)+53440
 105 A(1)=32:A(2)=32
 110 A(1)=PEEK(X):A(2)=PEEK(X+64):P=0:GOTO210
 150 IF Q=5ORINT(RND(9)*50)>47THEN 500
 152 IFPEEK(E2)=226ORPEEK(X)=226ORPEEK(X+C)=226ORA1=226ORA2=226THEN800
 153 IF W=5ORINT(RND(X)*50)>45THEN600
 155 REM
 160 IF Q=0 THEN FORT=1 TO 90:NEXT
 161 IF W=0 THENFORT=1TO90:NEXT
 170 PRINTCHR$(13)"SCORE:";SC;
 175 POKE530,1:POKE57088,3:T=PEEK(57088):POKE530,0:T=(T)AND46
 200 IF((T)AND36)>0THEN210
 202 IF((T)AND8)>0THEN300
 204 IF((T)AND2)>0THEN225
 206 GOTO 227
 210 IF((T)AND38)=32THEN213
 211 P=P-1:IFP<1THENP=4
 212 GOTO 214
 213 P=P+1:IFP>4THENP=1
 214 POKEX,A(1):POKEX+B,A(2)
 215 A=P(P,1):B=P(P,2):C=P(P,3):A(1)=PEEK(X):A(2)=PEEK(X+B):GOTO230
 220 WORKING
 225 POKE X,A(1):POKEX+B,A(2):M=M-B:IFABS(M)>256THENM=256*SGN(M)
 226 GOTO 230
 227 IF M=0THEN150
 228 POKEX,A(1):POKEX+B,A(2)
 230 X=X+M:IFX>55167ORX<53440THENX=X+(1664*SGN(54100-X))
 235 A(1)=PEEK(X):IFA(1)=226ORA(1)=4THEN800
 236 A(2)=PEEK(X+B):IFA(2)=226ORA(2)=4THEN800
 237 POKEX,A:POKEX+B,C:GOTO150
 299 REM ****-------Space-ship-fire-control--------
 300 I=0:FORT=X-BTOX-B*5STEP-B:V=PEEK(T):IFV<>32ANDV<>46THEN350
 310 I=I+1:X(I)=V:POKET,A(P+2):NEXT
 320 I=0:FORT=X-BTOX-B*5STEP-B:I=I+1:POKET,X(I):NEXT:GOTO227
 350 IFV<>4ANDV<>226 THEN V=32:GOTO310
 360 IF V=226 THEN 375
 365 FORV=1TO6:POKET,158:FORT1=1TO20:NEXT:POKET,32:FORT1=1TO17:NEXTT1,V
 370 SC=SC+100:J=INT(RND(X)*1700)+53440:E2=J:W=0:GOTO320
 375 IFR=TTHENV=T:FORD=1TOO:POKER+R(D),S(D):NEXT:R=R+R(1):GOTO380
 376 FORD=1TOOO:IFT<>R+R(D)THENNEXT:GOTO320
 377 F=D:V=R+R(D):R(D)=(55200-R)
 380 FORD=1TO6:POKEV,232:FORU=1TO15:NEXT:POKEV,233:FORU=1TO15:NEXTU,D
 385 POKE V,S(F):SC=SC+10:GOTO320
 400 STOP
 499 REM ASTEROID CONTROL
 500 IF Q=5 THEN 570
 505 R=INT(RND(X)*63)+53440:U=INT(RND(4)*3)+1:O=INT(RND(5)*A9)
 506 FORT=1TOO:R(T)=INT(RND(X)*512)+1:NEXTT
 510 Q=5:ON U GOTO 515,520,525
 515 S=63:GOTO559
 520 S=64:GOTO559
 525 S=65:GOTO559
 559 S1=PEEK(R):POKER,226:IFS1<>46THENS1=32
 560 FORT=1TOO:S(T)=PEEK(R+R(T)):POKER+R(T),226:NEXT
 567 GOTO 152
 570 POKER,S1:FORT=1TOO:IFS(T)<>46THENS(T)=32
 572 POKER+R(T),S(T):NEXT:R(1)=R(1)+INT(RND(Y)*2)+1
 573 R(3)=R(3)+INT(RND(R)*3)-2:R(4)=R(4)+INT(RND(Y)*2)+1
 575 R(5)=R(5)+INT(RND(3)*2):IFR<55167THENR=R+S:GOTO559
 580 Q=0:POKE56900,1:GOTO 152
 599 REM ALIEN CONTROL
 600 V=X:IFW=5THEN650
 601 E=INT(RND(X)*8)+1:EE=INT(RND(X)*10)+1:POKEJ,E3
 602 T=ABS(J-X):IFT>768 THENONEGOTO610,612,614,616,618,620,622,624
 603 V1=-SGN(J-(X+3*M)):T=ABS(J-(X+3*M)):T2=63:IFT<63THEN609
 604 FORT3=1TO3:T1=T/T2:IFT1-INT(T1)<.2THENEE=INT(T1):E1=T2*V1:GOTO630
 605 T2=T2+1:NEXT:IFV1=1THENONPGOTO611,612,614,611
 606 IFV1=-1THENONPGOTO618,620,622,618
 609 IF T<63 THENEE=12:E1=-SGN(J-X):GOTO630
 610 ONEGOTO611,612,614,616,618,620,622,624
 611 E1=64:GOTO 630
 612 E1=65:GOTO 630
 614 E1=63:GOTO 630
 616 E1=1:GOTO 630
 618 E1=-65:GOTO630
 620 E1=-63:GOTO630
 622 E1=-64:GOTO630
 624 E1=-1:GOTO630
 630 W=5
 631 FORE2=JTOJ+EE*E1STEPE1:IFE2=XORE6=X+CTHEN700
 635 E3=PEEK(E2):POKEE2,4:IFE3=226THEN800
 636 IF E2>55167THEN POKEE2,E3:E2=E2-1664:J=E2:GOTO630
 637 IF E2<53440THEN POKEE2,E3:E2=E2+1664:J=E2:GOTO630
 640 GOTO 155
 650 POKEE2,E3:IFJ+EE*E1=E2THENPOKEE2,4:J=E2:W=0:GOTO155
 655 NEXT:POKEE2,4:J=E2:W=0:GOTO155
 699 REM COLLISION WITH ALIEN
 700 POKEX,32:POKEX+B,32:POKEE2,32
 710 T1=X:T2=X:T3=X:T4=X
 720 FORT5=1TO20
 730 T1=T1-63:T2=T2-65:T3=T3+63:T4=T4+65
 735 Y1=PEEK(T1):Y2=PEEK(T2):Y3=PEEK(T3):Y4=PEEK(T4)
 740 POKE T1,198:POKET2,196:POKET3,197:POKET4,195
 745 FORT6=1TO25:NEXT
 747 POKET1,Y1:POKET2,Y2:POKET3,Y3:POKET4,Y4:NEXT:W=0:GOTO840
 799 REM EXPLOSION 1st part asteroid ret up
 800 IFE3=226ORPEEK(E2)=226ORS1=226THEN850
 801 IFPEEK(X)<>226ANDPEEK(X+C)<>226ANDA1<>226ANDA2<>226THEN153
 802 POKEX,32:POKEX+C,46:IFPEEK(X+64)=226THENX=X+64
 803 IFPEEK(X+65)=226 THENX=X+65
 804 IFPEEK(X+63)=226 THENX=X+63
 805 IFPEEK(X+126)=226 THENX=X+126
 806 IFPEEK(X+130)=226 THENX=X+130
 807 POKEX,226
 808 SC=SC-25:FORT=1TO4:T(T)=X:NEXT
 813 ON P GOTO 814,815,816,817
 814 P1=196:P2=198:P3=C:GOTO818
 815 P1=198:P2=C:P3=196:GOTO818
 816 P1=C:P2=196:P3=198:GOTO818
 817 P1=196:P2=C:P3=198:GOTO818
 818 IF ABS(M)>61 OR M=0 THEN 827
 819 IF M>0 THEN T(1)=T(1)-65:T(2)=T(2)-2:T(3)=T(3)+63
 820 IF M<0 THEN T(1)=T(1)-63:T(2)=T(2)+2:T(3)=T(3)+65
 821 FORT5=1TO3:Y(T5)=PEEK(T(T5)):NEXT
 822 POKET(1),P1:POKET(2),P2:POKET(3),P3
 823 FORT5=1TO25:NEXT:FORT5=1TO3:POKET(T5),Y(T5):NEXT
 824 IF T<20 THEN T=T+1:GOTO819
 825 GOTO 840
 827 IF P4=1THEN 829
 828 P4=1:ONPGOTO817,816,815,814
 829 FOR T=1TO20
 830 IF M>0 THEN T(1)=T(1)-65:T(2)=T(2)-64:T(3)=T(3)-63
 831 IF M<=0THEN T(1)=T(1)+63:T(2)=T(2)+64:T(3)=T(3)+65
 832 FOR T5=1TO3:Y(T5)=PEEK(T(T5)):NEXT
 833 POKE T(1),P1:POKET(2),P2:POKET(3),P3
 834 FORT5=1TO25:NEXT:FORT5=1TO3:POKET(T5),Y(T5):NEXT
 835 NEXTT:GOTO 840
 840 P4=0:POKEX,32:POKEX+C,46:X=INT(RND(9)*1720)+53440
 841 A(1)=32:A(2)=46:M=0:P=INT(RND(9)*3)+1:GOTO 150
 850 E3=32:GOTO150
 899 REM ALIEN FIRE CONTROL
 900 IF PEEK(57088)=0ANDINT(RND(X)*50)>29 THEN 170
 901 O1=6
 902 IF PEEK(E2)<>4 THEN 170
 903 IFE2=X-63ORE2=X-126ORE2=X-189ORE2=X-252THEN914
 904 IF E2=X+1ORE2=X+2ORE2=X+3ORE2=X+4ORE2=X+5ORE2=X+6THEN919
 905 IFE2=X-1ORE2=X-2ORE2=X-3ORE2=X-4ORE2=X-5ORE2=X-6THEN915
 906 IF E2=X+64ORE2=X+128ORE2=X+192 OR E2=X+256 THEN916
 907 IF E2=X+65ORE2=X+130ORE2=X+195ORE2=X+260 THEN917
 908 IFE2=X+63ORE2=X+126ORE2=X+189ORE2=X+252 THEN 918
 909 IFE2=X-64ORE2=X-128ORE2=X-192ORD2=X-256THEN912
 910 IFE2=X-65ORE2=X-130ORE2=X-195ORE2=X-260THEN913
 911 GOTO 960
 912 S2=64:N3=140:GOTO920
 913 S2=65:N3=190:GOTO920
 914 S2=63:N3=189:GOTO920
 915 S2=1 :N3=131:GOTO920
 916 S2=-64:N3=140:GOTO920
 917 S2=-65:N3=190:GOTO920
 918 S2=-63:N3=189:GOTO920
 919 S2=-1 :N3=131
 920 J=E2:N1=J:W=0
 921 N1=N1+S2:N2=PEEK(N1):POKEN1,N3:FORT5=1TO20:NEXT:POKEN1,N2
 925 IF N2<>32 AND N2<>46 THEN 950
 930 IF N1<>J+S2*O1 THEN 921
 940 IF INT(RND(9)*50)>47 THEN 600
 941 GOTO 170
 950 IFN1=XORN1=X+CTHENPOKEN1,232:FORT=1TO25:NEXT:POKEX,32:M=-S2
 951 IFN1=XORN1=+CTHENPOKEX+C,32:GOTO808
 960 GOTO 170
 1000 DATA 193,64,145,194,-1,147,191,-64,144,192,1,146,149,148,149,148
