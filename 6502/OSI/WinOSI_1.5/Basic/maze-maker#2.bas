REM MAZE MAKER (a unique way to generate a maze)

 0 GOTO100
 1 FORX=1TO30:PRINT:NEXT
 4 POKE56900,0
 5 POKE130,215:POKE129,64
 8 FORI=1TO55
 9 A$=A$+CHR$(WL)
 10 NEXT
 11 FORX=1TO2
 12 B$=B$+CHR$(WL)
 13 NEXT
 20 X=31
 25 FORY=0TO32:POKEX+Y*64+SC,32:NEXT
 50 RETURN
 100 DIMA(3)
 110 A(0)=2:A(1)=-128:A(2)=-2:A(3)=128
 115 SC=53504
 116 WL=161
 117 HL=32
 118 A=SC+65
 200 GOSUB1
 201 FORY=0TO24:POKESC+63+64*Y,32:NEXT
 210 POKEA,4
 220 J=INT(RND(1)*4):X=J
 230 B=A+A(J):IFPEEK(B)=WLTHENPOKEB,J:POKEA+A(J)/2,HL:A=B:GOTO220
 240 J=(J+1)*-1*(J<3):IFJ<>XTHEN230
 250 J=PEEK(A):POKEA,HL:IFJ<4THENA=A-A(J):GOTO220
 290 K=57088
 291 POKE530,1
 292 POKE57088,128
 295 PS=SC+93
 299 K=57088
 300 M=240:J=2
 301 POKEA,M
 310 B=A+A(J)/2:IFPEEK(B)=HLTHENPOKEB,M:POKEA,HL:A=B:J=(J+2)+4*(J>1)
 315 GOSUB500
 320 J=(J-1)-4*(J=0):GOTO310
 500 P=PEEK(K)
 501 D=0
 505 IFP=128THEND=-64
 510 IFP=64THEND=64
 515 IFP=32THEND=-1
 520 IFP=16THEND=1
 525 OL=PS
 530 IFPEEK(PS+D)=WLTHEN600
 532 IFPEEK(PS+D)=240ORPEEK(PS-D)=240THEN700
 535 PS=PS+D
 540 POKEOL,32
 545 POKEPS,241
 600 RETURN
 700 K=K+1:IFK>10THEN720
 710 GOTO535
 720 CLEAR:PRINTFRE(8):GOTO0


