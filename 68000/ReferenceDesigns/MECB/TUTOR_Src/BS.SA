BS       IDNT      1,0       BS (Block Search) Command               11/27/81         XDEF      BSCMD SPC 1         XREF      CKWADR         XREF.S    DUMPTEMP         XREF      FIXBUF         XREF      FNEXTF         XREF      GETA         XREF      GETNUMA         XREF      MACSBUG         XREF      OUT1CR         XREF      P2PHY         XREF      PNT2HX         XREF      PNT4HX         XREF      PNT6HX         XREF      PNT8HX         XREF      SYNTAX SPC 3         SECTION   11**  BLOCK SEARCH   BS <ADDR1> <ADDR2> 'LITERAL STRING'*                 BS <ADDR1> <ADDR2> <DATA> [<MASK>] [;<OPTION>]*BSCMD    LEA       SYNTAX(PC),A0         BSR       FNEXTF         BSR       GETA         MOVE.L    D0,A3     A3 = FROM BEGIN ADDRESS SPC 1         BSR       FNEXTF         BSR       GETA         MOVE.L    D0,A1     A1 = FROM END ADDRESS SPC 1         BSR       FNEXTF         MOVE.B    (A5),D0         CMP.B     #$27,D0         BEQ       BS311     LITERAL STRING SEARCH SPC 1         BSR       GETNUMA         MOVE.L    D0,D7     D7 = DATA WE ARE LOOKING FOR         CLR.L     D5        SCAN FOR OPTIONS         MOVE.L    A5,A0BS91     CMP.L     A6,A0         BCC.S     BS97      AT END OF BUFFER SPC 1         MOVE.B    (A0)+,D0         CMP.B     #';',D0         BNE       BS91      NOT SEMICOLON SPC 1         MOVE.L    A0,A6         SUB.L     #1,A6     ADJUST END OF BUFFER POINTER SPC 1         MOVE.B    (A0),D0   D0 = OPTION CHARACTER         CMP.B     #'B',D0         BEQ.S     BS97      BYTE  D5 = 0 SPC 1         MOVE.L    #1,D5         CMP.B #'W',D0         BEQ.S     BS97      WORD   D5 = + SPC 1         MOVE.L    #-1,D5    LONG WORD  D5 = -         CMP.B     #'L',D0         BNE       SYNTAXBS97     DS        0 SPC 1         MOVE.L    #-1,D4    D4 = DEFAULT SEARCH MASK         LEA       BS101(PC),A0         BSR       FNEXTF    FIND NEXT FIELD         BSR       GETNUMA         MOVE.L    D0,D4     D4 = MASKBS101    DS        0 SPC 1         MOVE.L    A3,A0         BSR       P2PHY     PRINT ADDRESSES (A0) & (A1) SPC 1         CMP.L     A3,A1         BCS       SYNTAX    END LESS THAN BEGIN SPC 1BS200    CMP.L     A1,A3         BCC       MACSBUG   DONE SPC 1         BSR       FIXBUF         MOVE.L    A3,D0         BSR       PNT6HX    FORMAT ADDRESS         MOVE.B    #' ',(A6)+  SPACE INTO BUFFER SPC 1         TST.L     D5         BEQ.S     BS225     BYTE SIZE SPC 1         MOVE.L    A3,D0         BSR       CKWADR    INSURE WORD BOUNDRY         TST.L     D5         BPL.S     BS219     WORD SIZE (2 BYTES) SPC 1         MOVE.L    #2,D6     D6 =  SIZE (LONG WORD)         MOVE.L    (A3),D0   FETCH         AND.L     D4,D0     MASK         CMP.L     D7,D0     COMPARE         BNE.S     BS215 SPC 1         MOVE.L    (A3),D0   DISPLAY  NON-MASKED DATA         BSR       PNT8HX SPC 1BS213    BSR       OUT1CR SPC 1BS215    ADD.L     D6,A3     BUMP FETCH ADDRESS  (D6 = SIZE)         BRA       BS200 SPC  1BS219    MOVE.L    #2,D6     SIZE = WORD         MOVE.W    (A3),D0         AND.W     D4,D0         CMP.W     D7,D0         BNE       BS215 SPC 1         MOVE.W    (A3),D0         BSR       PNT4HX    DISPLAY         BRA       BS213 SPC 1BS225    MOVE.L    #1,D6     SIZE = BYTE         MOVE.B    (A3),D0         AND.B     D4,D0         CMP.B     D7,D0         BNE       BS215 SPC 1         MOVE.B    (A3),D0         BSR       PNT2HX    DISPLAY         BRA       BS213 PAGE* LITERAL STRING SEARCH*   SAVE STRINGBS311    LEA       DUMPTEMP,A2BS313    ADD.L     #1,A5         CMP.L     A6,A5         BCC       SYNTAX    ADDR1 GREATER THAN ADDR2         MOVE.B    (A5),(A2)+         MOVE.B    (A5),D0         CMP.B     #$27,D0         BNE       BS313         SUB.L     #1,A2     A2 = END OF STRING + 1 SPC 1         MOVE.L    A3,A0         BSR       P2PHY     DISPLAY ADDRESSES SPC 1         CMP.L     A3,A1         BCS       SYNTAX SPC 1* LOOK FOR STRING MATCHBS323    LEA       DUMPTEMP,A4         A4 = BEGIN OF STRING         MOVE.L    A3,A0               A0 = BEGIN OF MEMORYBS325    MOVE.B    (A0),D0         CMP.B     (A4)+,D0            DATA COMPARE         BNE.S     BS365               MIS-MATCH SPC 1         CMP.L     A0,A1               ADDRESS CHECK         BCS       MACSBUG             OUT OF MEMORY SPC 1         ADD.L     #1,A0         CMP.L     A2,A4         BCS       BS325               MORE STRING TO CHECK SPC 1         BSR       FIXBUF              HAVE MATCH         MOVE.L    A3,D0               FORMAT ADDRESS         BSR       PNT6HX         MOVE.B    #' ',(A6)+          SPACE SPC 1         MOVE.B    #$27,(A6)+          LEADING QUOTE         LEA       DUMPTEMP,A4         MOVE STRING TO BUFFERBS355    MOVE.B    (A4)+,(A6)+         CMP.L     A4,A2         BCC       BS355 SPC 1         BSR       OUT1CR              DISPLAY SPC 1BS365    ADD.L     #1,A3         CMP.L     A3,A1         BCS       MACSBUG             DONE         BRA       BS323 SPC 3         END