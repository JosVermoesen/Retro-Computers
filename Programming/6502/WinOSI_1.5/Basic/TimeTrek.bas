
REM Time Trek..............................

 2 GOSUB9:PRINTTAB(25)"STAR TREK":FORI=0TO12:PRINT:NEXT:E=5000:GOTO12
 3 FORN=1TOLEN(A$):POKEL+53000+N,ASC(MID$(A$,N,1)):NEXT:IFMSTHENRETURN
 6 POKEL+53000+N,32:RETURN
 7 FORJ=0TO1500:NEXT
 8 PRINTCHR$(13)"                       ";:PRINTCHR$(13);:RETURN
 9 FORI=0TO31:PRINT:NEXT:RETURN
 10 L=812:A$=STR$(O-T)+" ":GOSUB3:RETURN
 11 K=K+(N<X2)+(N<Y2)+(N<.45)+(N<.25)+(N<.16)+(N<.09):D=D-K:RETURN
 12 DIMD(5),I(7),J(7),K(7),S(7,7),Q(7,7),D$(5),L(5),C(4):POKE12,253
 15 L(0)=1581:L(1)=1245:L(2)=1884:L(3)=1389:L(4)=1197:L(5)=1218
 20 C(0)=58:C(1)=126:C(2)=123:C(3)=232:C(4)=42:D$(0)="ENGINES":G=53597
 25 D$(1)="SR SENSORS":D$(2)="LR SENSORS":D$(3)="PHASERS":POKE11,0
 26 D$(4)="TORPEDOS":D$(5)="RECORDS":GOSUB175:Q=X:R=Y:X=8:Y=1:X1=.25
 27 PRINT"1-NOVICE OR 2-EXPERT"
 28 GOSUB805:FORI=0TOM:X=RND(1):NEXT:H=J:GOSUB9:X=8
 35 GOSUB725:DEFFND(N)=SQR((I(I)-U)^2+(J(I)-V)^2):Y1=7.55:X2=6.28
 40 Y2=1.9:T=3431:O=T+31.5:E=4000:P=10:FORI=0TO7
 45 FORJ=0TO7:K=0:N=RND(Y):IFN<X1THENN=N*64:K=(N<Y1)-Y:GOSUB11
 50 B=(RND(Y)>.96):BA=BA-B:Q(I,J)=K*100+B*10-INT(RND(Y)*X+Y):NEXTJ,I
 55 IFD>30THENO=T+D
 60 IFBA>0THEN70
 65 GOSUB175:Q(X,Y)=Q(X,Y)-10:BA=1
 70 DM=1:IFH=1THENT=T-.5*D
 85 A=0:IFQ<0ORQ>7ORR<0ORR>7THENN=0:S=0:K=0:GOTO95
 90 N=ABS(Q(Q,R)):Q(Q,R)=N:S=N-INT(N/10)*10:K=INT(N/100)
 95 B=INT(N/10-K*10):GOSUB175:U=X:V=Y
 100 FORI=0TO7:FORJ=0TO7:S(I,J)=1:NEXTJ,I:S(U,V)=2
 105 FORI=0TO7:K(I)=0:X=8:IFI<KTHENGOSUB180:S(X,Y)=3:K(I)=400
 110 I(I)=X:J(I)=Y:NEXT:I=S:IFB>0THENGOSUB180:S(X,Y)=4
 115 IFI>0THENGOSUB180:S(X,Y)=5:I=I-1:GOTO115
 120 GOSUB125:GOSUB635:GOTO320
 125 GOSUB270:IFA=0ORK>0THENGOSUB190
 130 I=1:IFD(I)<=0THEN140
 135 FORI=0TO7:FORJ=0TO7:POKEG+3*J+64*I,32:NEXTJ,I:GOTO145
 140 FORI=0TO7:FORJ=0TO7:POKEG+3*J+64*I,C(S(I,J)-1):NEXTJ,I
 145 L=620:A$=STR$(T)+" ":GOSUB3:GOSUB10
 150 A$=" CONDITION "+C$+" ":L=403-LEN(A$)/2:GOSUB3
 155 L=1004:A$=STR$(INT(E))+"  ":GOSUB3:IFO=0THENRETURN
 160 L=1166:A$=STR$(Q+1)+STR$(R+1):GOSUB3:L=1964:A$=STR$(D):GOSUB3
 165 IFD(4)=0THENL=1195:A$=" "+STR$(P)+"   ":GOSUB3
 170 L=1772:A$=STR$(BA):GOSUB3:RETURN
 175 X=INT(RND(1)*8):Y=INT(RND(1)*8):RETURN
 180 GOSUB175:IFS(X,Y)>1THEN180
 185 RETURN
 190 IFK<1ANDNOTZTHENRETURN
 195 IFK>0THENZ=-1:GOTO225
 200 L=54529:FORI=1TO24:FORJ=0TO7:POKEL+I+64*J,32:NEXTJ,I
 205 GOSUB270:GOSUB150:A$="ALL CLEAR":L=1536:GOSUB3:Z=0:MS=1:RETURN
 225 IFDKTHENPRINTCHR$(13)"SHIELDED BY STARBASE";:RETURN
 230 FORI=0TO7:IFK(I)<=0THENNEXT:RETURN
 235 H=K(I)*.42*RND(1):K(I)=K(I)-H:H=H/(FND(0)^.1):E=E-H:J=G+3*V+64*U
 245 IFD(I)=0THENFORN=0TO30:POKEJ,226:POKEJ,126:NEXT
 246 IFH<.1THENH=.0111
 248 GOSUB255:IFY=99THENRETURN
 250 NEXT:RETURN
 255 L=I*64+1529:IFK(I)<0THENA$="***KLINGON DESTROYED***":GOTO265
 260 A$=STR$(H)+"      "+STR$(K(I))
 265 GOSUB3:RETURN
 270 DK=0:FORI=U-1TOU+1:FORJ=V-1TOV+1:IFI<0ORI>7ORJ<0ORJ>7THEN280
 275 IFS(I,J)=4THENC$="DOCKED":E=4000:P=10:DK=1:GOSUB295:RETURN
 280 NEXTJ,I:IFK>0THENC$="RED":RETURN
 285 IFE<400THENC$="YELLOW":RETURN
 290 C$="GREEN":RETURN
 295 IFD(1)THENDS=1
 296 IFD(2)THENDL=1
 297 IFD(5)THENDM=1
 298 F=1:FORN=0TO5:D(N)=0:NEXT:RETURN
 300 PRINTCHR$(13)D$(I)" DAMAGED";:GOSUB7
 305 A$=STR$(D(I))+" YRS"
 310 L=L(I):GOSUB3:RETURN
 320 IFFTHENGOSUB775:F=0
 321 IFDSTHENGOSUB130:DS=0
 322 GOSUB8:IFDLTHENGOSUB635:DL=0
 323 IFDMORMSTHENGOSUB660:DM=0:MS=0
 325 PRINT"COMMAND?";:GOSUB805:A=J:ONAGOTO350,330,330,565,340
 330 GOTO320
 340 I=4:GOSUB8:IFD(I)>0THENGOSUB300:GOTO320
 345 N=15:IFP<1THENPRINT"TORPEDOS EXPENDED";:GOSUB7:GOTO320
 350 GOSUB8:PRINT"COURSE(1-8.9)?";:GOSUB805:C=J:IFC<1THEN320
 355 IFC>=9THEN350
 360 IFA<>5THEN370
 365 P=P-1:PRINTCHR$(13)"TRACKING PHOTON TORPEDO";:GOTO445
 370 GOSUB8:PRINT"WARP(0-12)?";:GOSUB805:W=J:IFW<=0ORW>12THEN350
 375 GOSUB8:IFW<=.5ORD(0)<=0THEN385
 380 GOSUB8:PRINT"MAXIMUM WARP IS .5!";:GOSUB7:GOTO370
 385 GOSUB190
 395 IFRND(1)>.25ORE>RND(1)*500+2500ORO-T<5THEN430
 400 X=INT(RND(1)*6):IFRND(1)>.5THEN415
 405 D(X)=D(X)+INT(4*RND(1)+1):L=2006:A$="====ION STORM====":GOSUB3
 406 IFX=2THENDL=1
 407 IFX=1THENDS=1
 408 IFX=5THENDM=1
 410 GOSUB7:I=X:GOSUB300:D(X)=D(X)+1:L=2006:A$=""
 412 GOSUB3:GOTO430
 415 FORI=XTO5:IFD(I)>0THEN425
 420 NEXT:FORI=0TOX:IFD(I)<=0THENNEXT:GOTO430
 425 D(I)=.5
 430 FORI=0TO5:IFD(I)=0THEN440
 435 D(I)=D(I)-1:F=1:IFD(I)>0THEN440
 436 IFD(I)<=0THEND(I)=0:GOSUB7:PRINTD$(I)" ARE FIXED";
 437 IFI=1ANDD(I)=0THENDS=1
 438 IFI=2ANDD(I)=0THENDL=1
 439 IFI=5ANDD(I)=0THENDM=1
 440 NEXT:N=INT(W*8):E=E-N-N+.5:S(U,V)=1
 445 Y1=U+.5:X1=V+.5:Y=(C-1)*.785398:X=COS(Y):Y=-SIN(Y)
 450 IFA=1ANDD(1)=0THENPOKEG+3*V+64*U,58
 455 FORI=1TON:Y1=Y1+Y:X1=X1+X
 456 IFD(1)=0ANDX2>-1ANDX2<8ANDY2>-1ANDY2<8THENPOKEG+3*X2+64*Y2,58
 460 Y2=INT(Y1):X2=INT(X1):IFX2<0ORX2>7ORY2<0ORY2>7THENGOTO550
 465 H=G+3*X2+64*Y2:C=126:IFA=5THENC=111
 470 IFS(Y2,X2)<>1THEN475
 471 IFD(1)=0THENPOKEH,C:FORJ=0TO60:NEXTJ
 472 NEXTI:T=T+.1*I:GOTO530
 475 IFA=5ANDD(1)=0THENFORJ=32TO58:POKEH,J:NEXT
 480 GOSUB8:IFA=1THENPRINT"BLOCKED BY ";
 485 ONS(Y2,X2)-3GOTO520,510
 490 IFA=1THENPRINT"KLINGON";:GOTO525
 495 FORI=0TO7:IFY2<>I(I)THEN505
 500 IFX2=J(I)THENK(I)=-5:GOSUB255
 505 NEXT:K=K-1:D=D-1:GOTO540
 510 PRINT"STAR";:IFA=5THENS=S-1:GOTO535
 515 GOTO525
 520 PRINT"STARBASE";:IFA=5THENB=0:BA=BA-1:GOTO535
 525 Y2=INT(Y1-Y):X2=INT(X1-X):IFD(1)=0THENPOKEG+3*X2+64*Y2,126
 530 U=Y2:V=X2:S(U,V)=2:GOTO545
 535 PRINT" DESTROYED!";
 540 S(Y2,X2)=1:Q(Q,R)=K*100+B*10+S:IFD(1)=0THENPOKEG+3*V+64*U,126
 541 IFD<1THEN705
 545 GOSUB190:GOSUB270:GOSUB150:GOTO320
 550 IFA=5THENGOSUB8:PRINT"<<<<<<<<MISSED>>>>>>>>";:GOTO545
 555 T=T+1:Q=INT(Q+W*Y+(U+.5)/8):R=INT(R+W*X+(V+.5)/8)
 560 Q=Q-(Q<0)+(Q>7):R=R-(R<0)+(R>7):GOTO85
 565 I=3:IFD(I)>0THENGOSUB300:GOTO320
 570 GOSUB8:PRINT"UNITS TO FIRE?";:GOSUB805:X=J:GOSUB8:IFX=0THEN320
 575 IFX>ETHENPRINT"ONLY HAVE"E"UNITS";:GOSUB7:GOTO570
 580 E=E-X:GOSUB155:Y=K:FORI=0TO7
 590 IFK(I)<=0THEN625
 595 H=X/(Y*(FND(0)^.4)):K(I)=K(I)-H:J=G+3*J(I)+64*I(I)
 600 IFD(I)=0THENFORN=0TO20:POKEJ,226:POKEJ,123:NEXT
 605 IFK(I)>0THEN615
 610 IFD(I)=0THENFORN=33TO58:POKEG+3*J(I)+64*I(I),N:NEXTN
 615 GOSUB255:IFK(I)>0THEN625
 620 K=K-1:D=D-1:S(I(I),J(I))=1:Q(Q,R)=Q(Q,R)-100
 625 NEXT:IFD<1THEN705
 630 GOTO545
 635 A=3:I=2:L=1432:IFD(I)<=0THEN645
 640 FORI=0TO4:FORJ=1TO13:POKE54432+J+64*I,32:NEXTJ,I:RETURN
 645 FORI=Q-1TOQ+1:FORJ=R-1TOR+1
 650 IFI<0ORI>7ORJ<0ORJ>7THENA$="***":GOTO700
 655 Q(I,J)=ABS(Q(I,J)):GOTO680
 660 A=6:I=5:L=569:IFD(I)=0THEN675
 670 FORI=1TO24:FORJ=0TO7:POKE53569+I+64*J,32:NEXTJ,I:RETURN
 675 FORI=Q-1TOQ+1:FORJ=R-1TOR+1:IFDMTHENFORI=0TO7:FORJ=0TO7
 676 IFI<0ORI>7ORJ<0ORJ>7THENNEXTJ,I:RETURN
 677 IFQ(I,J)<0THENA$="<->":GOTO681
 680 A$=STR$(Q(I,J)):A$="00"+MID$(A$,2):A$=RIGHT$(A$,3):IFA=3THEN700
 681 IFDMTHEN685
 682 L=569+3*J+64*I:GOSUB3:NEXTJ,I:MF=0:RETURN
 685 GOSUB3:L=L+3:NEXTJ:POKEL+53001,139:L=L+40:NEXTI:RETURN
 700 GOSUB3:L=L+5:NEXTJ:POKEL+52999,139:L=L+113:NEXT:MS=1:RETURN
 705 PRINT:PRINTTAB(6)"-YOU WIN-":END
 725 L=53505:A=25:B=9:GOSUB763:L=53532:A=23:B=9:GOSUB763:L=54337
 726 A=25:B=11:GOSUB763:L=54368:A=14:B=6:GOSUB763:L=557:A$="STARDATE"
 728 GOSUB3:L=749:A$="TIME":GOSUB3:L=941:A$="ENERGY":GOSUB3:L=1133
 730 A$=D$(4):GOSUB3:L=1325:A$=D$(3):GOSUB3:L=1517:A$=D$(0):GOSUB3
 732 L=1709:A$="STARBASES":GOSUB3:L=1901:A$="KLINGONS":GOSUB3:L=1144
 734 A$="GALACTIC MAP--QUADRANT":GOSUB3:L=1175:A$="SHORT RANGE SCAN"
 736 GOSUB3:L=1402:A$=">>>BATTLE COMPUTER<<<":GOSUB3:L=1466
 738 A$="UNIT HIT   ENERGY LEFT":GOSUB3:L=1815:A$="LONG RANGE SCAN"
 740 GOSUB3:F=1:RETURN
 763 FORI=1TOA:POKEL+I,131:POKEL+I+64*B,132:NEXT:FORI=1TOB
 764 POKEL+64*I,140:POKEL+A+64*I,139:NEXT:POKEL+A,222:POKEL+A+64*B,223
 765 POKEL+64*B,220:POKEL,221:RETURN
 775 FORI=0TO5:IFD(I)<=0THENA$="READY ":GOSUB310:GOTO790
 785 GOSUB305
 790 NEXTI:GOSUB165:RETURN
 805 B$=" ":POKE530,1:X=57088
 810 POKEX,255:IFT>OTHENT=O:GOTO865
 815 IFE<1THENE=0:GOTO870
 820 IFZANDRND(1)>.99THENGOSUB861
 825 M=M+1:IFM>38THENT=T+.061:M=0:IFE<5000THENGOSUB10
 830 IFPEEK(X)=1THEN820
 835 X=USR(X):N=PEEK(531):IFN=67THENB$="0":GOTO860
 840 IFN=13THEN860
 845 PRINTCHR$(N);:B$=B$+CHR$(N)
 850 POKEX,255:IFPEEK(X)<>1THEN850
 855 GOTO820
 860 J=VAL(B$):POKE530,0:RETURN
 861 I=INT(RND(1)*K):IFK(I)<=0ORDKTHENRETURN
 863 Y=99:GOSUB235:RETURN
 865 FORI=1TO30:GOSUB10:A$=" ":GOSUB3:NEXT:GOTO875
 870 O=0:FORI=0TO30:GOSUB155:A$=" ":GOSUB3:NEXT
 875 GOSUB8:PRINTTAB(6)"-YOU LOSE-":END
