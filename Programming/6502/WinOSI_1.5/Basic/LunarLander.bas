
REM Lunar Lander #2  (I=moon surface) TYPE 2#s FOR FUEL

 10 REM LUNAR LANDER
 30 FORT=1TO30:PRINT:NEXT:POKE56900,0:PRINT" BEGINNIG LANDING";
 31 PRINT" PROCEEDURE...":FORT=1TO12:PRINT:NEXT
 32 FORT=1TO10:PRINT:NEXT:FORT=1TO1500:NEXT:FORT=1TO5:PRINT:NEXT
 33 POKE56900,1
 40 PRINT"GOOD LUCK!!!"
 60 PRINT:PRINT:A$="AMOUNT OF FUEL ?  "
 70 PRINT"SEC FUEL SPEED DISTANCE"
 80 PRINT:T=0:H=500:V=50:F=120
 100 GOSUB 500
 160 FORZ=54912TO54911+LEN(A$):POKEZ,ASC(MID$(A$,Z-54911,1)):NEXT
 165 POKE 530,1:GOSUB 550
 170 IF B<0 THEN 300
 190 IF B>F THEN B=F
 200 V1=V-B+5:F=F-B:H=H-.5*(V+V1):IFH<=0THENGOSUB500:GOTO320
 240 T=T+1:V=V1:IFF>0 THEN 100
 270 IF B=0 THEN 290
 280 A$="*** OUT OF FUEL!!! ***    ":FORZ=54912TO54911+LEN(A$)
 285 POKEZ,ASC(MID$(A$,Z-54911,1)):NEXT:FORZ=1TO1000:NEXT
 290 GOSUB 500
 300 B=0
 310 GOTO 200
 320 A$="*** ** CONTACT! ** ***":FORZ=54912TO54911+LEN(A$)
 325 POKEZ,ASC(MID$(A$,Z-54911,1)):NEXT:FORZ=1TO1000:NEXT
 330 H=H+.5*(V1+V)
 340 IF B=5 THEN 370
 350 D=(-V+SQR(V*V+H*(10-2*B)))/(5-B)
 360 GOTO 380
 370 D=H/V:V1=V+(5-B)*D
 380 PRINT:PRINT:PRINT"TOUCHDOWN AT"T+D" SECONDS"
 400 PRINT:PRINT"LANDING VELOCITY="V1"FEET/SEC":PRINT
 410 PRINTF"UNITS OF FUEL REMAINING"
 415 PRINT
 420 IF V1<>0 THEN 450
 430 PRINT"CONGRATULATIONS!!! A PERFECT LANDING!"
 440 PRINT"YOUR LICENSE WILL BE RENEWED...LATER"
 450 IF ABS(V1)<2 THEN 480
 460 PRINT"HA,HA YOU BLEW IT"
 470 PRINT"CONDOLENCES WILL BE SENT TO YOUR NEXT OF KIN"
 480 PRINT:PRINT:PRINT:INPUT"ANOTHER MISSION (Y OR N) ";A$
 490 IF LEFT$(A$,1)="Y"THEN30
 495 PRINT"CONTROL OUT":END
 500 Q=INT(H+.5):W=H/12+20
 505 PRINTCHR$(13)TAB(62)" ";
 506 T$="*":W1=W:IFW>63THENW1=63:T$=""
 510 PRINTCHR$(13)TTAB(4)FTAB(10)VTAB(15)QTAB(20)"I"TAB(W1)T$;
 520 RETURN
 550 Z=128:Z1=1:Z2=0:A=0
 552 POKE 57088,128:P=PEEK(57088):IFP=0THEN 570
 554 IF Z<>PTHENZ=Z/2:Z1=Z1+1:GOTO554
 555 A=A*10+Z1:POKE54928+Z2,48+Z1:Z2=Z2+1:IFZ2>1THEN590
 560 FORZ=1TO200:NEXT:Z=128:Z1=1
 570 POKE57088,64:P=PEEK(57088):IFP=0ORP<32THEN552
 575 IFP=32THENPOKE54928+Z2,48:A=A*10+0:Z2=Z2+1:IFZ2>1THEN590
 578 IFP=128THENPOKE54928+Z2,56:A=A*10+8:Z2=Z2+1:IFZ2>1THEN590
 580 IFP=64THENPOKE54928+Z2,57:A=A*10+9:Z2=Z2+1:IFZ2>1THEN590
 585 FORZ=1TO200:NEXT:Z=128:Z1=1:GOTO552
 590 IFA>30THENPOKE54928,32:POKE54929,32:FORZ=1TO500:NEXT:GOTO550
 595 B=A:POKE530,0:RETURN
