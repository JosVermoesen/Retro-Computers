5     GOSUB INIT:CLEARW 2
30010 X0=320:Y0=-9:XM=639:YM=190:RS=2.54:GX=319:GY=199
30020 DIM IC(31,7):IC=0:FL(0)=1:FL(1)=-1:DX=0:DY=0
30050 GOSUB 35600: GOTO 30200
30100 AX=PX:AY=PY:IN=INP(2)
30110 GOSUB MAUS:POKE CONTRL,123:POKE INTIN,0:VDISYS
30120 IF KEY=2 THEN  GOSUB 35000
30130 IF MAUSX < X0 THEN 30110
30140 PX=MAUSX:PY=MAUSY
30200 LINEF AX+X0+1,AY+Y0+1,PX+X0+1,PY+Y0+1: GOTO 30100
35000 PX=PX-X0:PY=PY-Y0
35010 GOTOXY 4,3:PRINT "0:    1:    2:    3:    4:";
35020 GOTOXY 1,4:PRINT "STECKER  IC  DIREC. PLOT  RTN";
35030 GOTOXY 8,7:PRINT "Bitte auswaehlen !";
35040 IN=INP(2):IF IN<48 OR IN>52 THEN 35040
35050 ON IN-47 GOSUB 35100,35200,35300,35400,35500
35060 IF IN=52 THEN  RETURN 
35070 GOTO 35000
35100 REM  **0**
35110 INPUT "ANZAHL DER STIFTE=";P:RESTORE 39030: READ RB,RA,BH
35120 PO=P:BL=(P-2)*RA/2: RETURN 
35200 REM  **1**
35210 RESTORE 39000: INPUT "EINGABE DER POLZAHL ";P
35215 READ PO,BL,BH: IF PO=0 THEN 35210
35220 IF PO<>P THEN 35215
35225 RA=RS:RB=BH: RETURN 
35300 REM  **2**
35310 INPUT "RICHTUNG (HOCH,RECHTS)BEZ PIN 1          (0   ,1) ";D
35315 IF D<0 OR D>1 THEN 35310
35320 IX=PX*RS:IY=PY*RS:DX=IX+D*BL+(D-1)*BH:DY=IY+D*BH-(D-1)*BL
35325 IF DX>GX OR DY>GY THEN 35700
35330 Z=IC: FOR R=0 TO IC-1: IF IC(R,1)=IX AND IC(R,2)=IY THEN 35345
35335 NEXT :IC=IC+1: GOTO 35380
35340 IC=IC+1: IF Z=IC-1 THEN 35380
35345 Z=R: INPUT "BAUTEIL LOESCHEN (0,1) ";P: IF P<0 OR L>1 THEN 35345
35350 IF P=0 THEN 35380
35355 FOR R=0 TO 7:IC(Z,R)=IC(IC-1,R): NEXT 
35360 IC=IC-1: RETURN 
35380 IC(Z,0)=PO:IC(Z,1)=IX:IC(Z,2)=IY:IC(Z,3)=DX
35385 IC(Z,4)=DY:IC(Z,5)=RA:IC(Z,6)=RB:IC(Z,7)=D
35390 RETURN 
35400 REM  **3**
35410 LPRINT "OE;IN;IW;SC0,237,0,170;VS0;SP0;";
35412 LPRINT "PA0,0;PD";GX;0;GX;GY;0;GY;0;0;";PU;";
35415 FOR R=0 TO IC-1: FOR RE=0 TO 1
35420 DX=FL(RE)*(IC(R,7)-1):DY=FL(RE)*IC(R,7): FOR XX=1 TO IC(R,0)/2
35425 LPRINT "PA";IC(R,1+RE*2)+DY*(XX-1)*IC(R,5);
35427 LPRINT IC(R,2+RE*2)-DX*(XX-1)*IC(R,5);
35430 RESTORE 39010: READ P: FOR YY=1 TO P: READ X,Y
35435 IF X=5 THEN LPRINT "PU;";: GOTO 35450
35440 IF X=6 THEN LPRINT "PD;";: GOTO 35450
35445 GOSUB 35480
35450 NEXT : NEXT : NEXT : NEXT 
35455 LPRINT "OE;IN;";
35460 RETURN
35480 LPRINT "PR";DX*X+DY*Y;DY*X-DX*Y;: RETURN
35500 REM  **4**
35510 CLEARW 2: GOSUB 35600
35520 IF IC=0 THEN  RETURN 
35530 FOR R=0 TO IC-1:X=IC(R,1)/RS:Y=IC(R,2)/RS+Y0
35540 XX=IC(R,3)/RS:YY=IC(R,4)/RS+Y0
35545 FOR Z=X+X0 TO XX+X0 STEP  SGN (XX-X)
35550 LINEF Z+1,Y+1,Z+1,YY+1: NEXT : NEXT : RETURN
35600 REM  **RAND ZEICH.**
35606 XPOS1=X0:XPOS2=XM:YPOS1=Y0:YPOS2=YM
35610 FUELL=1:COLOR 1,1,1:GOSUB RECHTECK
35620 PX=0:PY= INT (YM/2):AX=0:AY=0: RETURN 
35700 PRINT "ERROR !!"
35710 RETURN
39000 DATA 14,15.24,7.62,16,17.78,7.62,24,27.94,15.24
39005 DATA 28,33.02,15.24,40,48.26,15.24,8,7.62,7.62,0,0,0
39010 DATA 25,1.7,0,6,0,0,-.18,-.8,0,0,-.36,-1.8,0,0,.2,1.44,0,0,.68
39015 DATA -1.08,0,0,-.52,-2.16,0,0,.36,1.8,0,0,.36,1.8,0,0,-.36,.8,0
39017 DATA 0,-.18,5,0,0,1.27,6,0,-4.4,0,4.4,0,5,0
39020 DATA 2,4.5,0,-4.5,0
39030 DATA 5.08,2.54,5.08
