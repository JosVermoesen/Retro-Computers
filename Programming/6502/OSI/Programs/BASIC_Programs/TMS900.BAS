1GOTO10
2AS=0
3FORR=1TO4:Z=ASC(MID$(AS$,R)):AS=AS+16^(4-R)*(Z-55-7*(Z<65)):NEXT
4RETURN
5T$="":T$=MID$(HE$,MA/16+1,1)+MID$(HE$,16*FRAC(MA/16)+1,1):RETURN
6X$=XO$+RIGHT$(STR$(X),LEN(STR$(X))-1):RETURN
7PRINTTAB(5);ZW$;TAB(11);CO$;:RETURN
10PRINT:PAGE:PRINTCHR$(127):POKE134,64:CLEAR
11RESTORE:HE$="0123456789ABCDEF":XO$="R"
15KEY=64768
16PRINT"/:M-CODEDISASSEMBLER":PRINT"$:HEXDISASSEMBLER"
17PRINT"*:M-CODEASSEMBLER":PRINT"=:HEXASSEMBLER"
20PRINT:INPUT"STARTADRESSE:";ST$:PRINT
21IFST$=""THEN16
22FO=ASC(ST$):ST$=MID$(ST$+"0000",2,4)
25AS$=ST$:GOSUB2:ST=AS:GOTO45
27MA=ST/256:GOSUB5:PRINTT$;:MA=256*FRAC(ST/256)
28GOSUB5:PRINTT$;"";:ST=ST+2:RETURN
30MH=PEEK(ST):ML=PEEK(ST+1)
40MA=MH:GOSUB5:ZW$=T$:MA=ML:GOSUB5:ZW$=ZW$+T$:RETURN
45IFFO=36THEN950
46IFFO=42THEN5000
47IFFO=61THEN5950
50GOSUB30:GOSUB27:SET1000+INT(MH/16)*100
60READA1,A1$,CO$,F:IFA1=0THEN180
70IFMID$(ZW$,1,A1)<>A1$THEN60
80IFF<10THEN160
85IFF=10THENGOSUB200:GOTO160
90SET100*F+(MHAND12)
100READCO$,F
160IFF=0THEN180
162SR=MLAND15:TS=3ANDML/16:DR=(3ANDML/64)+4*(MHAND3):TD=3ANDMH/4
165ONFGOSUB300,400,500,550,600,650,700,800,900
170PRINT:R=PEEK(57088):IFR=255THENR=CALLKEY,0:IFR=27THEN20
171IFR=>32THEN45
172PRINTCHR$(3);:STOP:GOTO45
175GOTO20
180PRINTTAB(5);ZW$;:GOTO170
200SET3000+MH*100:ZW=INT(ML/16)
210READF,CO$:IFF=0THENRETURN
220IFZW>=FTHEN210
230F=6:RETURN
250SET4200+TX:READA1$:IFTX=2THENRETURN
260X=TY:GOSUB6:A1$=A1$+X$:RETURN
300REMFORMAT1
301REM
305GOSUB7:GOSUB30:TX=TS:TY=SR:GOSUB250:F=0:ST=ST-2
307IFXO=1THENXO$=YO$
308IFXO=6THENA2$=A1$:A1$="":GOTO315
310A2$=A1$:TX=TD:TY=DR:GOSUB250
314XO$="R"
315IFTS<>2THEN319
317A2$=A2$+ZW$:F=1:ST=ST+2
318IFSRTHENX=SR:GOSUB6:A2$=A2$+"("+X$+")"
319IFTD<>2THEN325
320ST=ST+2:GOSUB30:A1$=A1$+ZW$:F=F+1:IFDR=0THEN325
322X=DR:GOSUB6:A1$=A1$+"("+X$+")"
325IFF=0THENST=ST+2
326PRINT"";A2$;",";A1$;
330IFF=0THENRETURN
335IFF=2THENST=ST-2:GOSUB30
340PRINT:GOSUB27:PRINTTAB(5);ZW$;:GOSUB30:F=F-1:GOTO330
400REMFORMAT2
401REM
405GOSUB7:IFMH>28THEN450
410TY=ML:TX=ST:IFML>127THENTY=(127ANDNOTML)+1
415ST=ST+2*TY*(2*(ML>127)+1):PRINT"$>";:GOSUB27:ST=TX:RETURN
430REM
450PRINT"";RIGHT$(ZW$,2);:RETURN
500REMFORMAT3
501REM
505TD=0:GOTO305
550REMFORMAT4
551REM
555YO$="C":GOTO910
600REMFORMAT5
601REM
605GOSUB7:X=SR:GOSUB6:PRINT"";X$",";STR$(INT(ML/16));:RETURN
650REMFORMAT6
651REM
655TD=0:XO=6:GOSUB305:XO=0:RETURN
700REMFORMAT7
701REM
705GOTO7
800REMFORMAT8
801REM
805GOSUB7:F=1:IFA1$="02A"ORA1$="02C"THENF=0
810GOSUB30:X=SR:GOSUB6:IFA1=4THENPRINT"";:GOTO820
812IFF=0THENPRINT"";X$;:RETURN
813PRINT"";X$;",";
820PRINT"#";ZW$;
825GOTO340
900REMFORMAT9
901REM
904YO$=""
905IF(MHAND46)<>46THEN505
910XO=1:GOSUB505:XO=0:RETURN
950GOSUB30:GOSUB27:PRINTZW$;"$";:ZW=MH:GOSUB980:ZW=ML
955GOSUB980:GOTO170
980IFZW<128ORZW>191THENPRINT".";:RETURN
985PRINTCHR$(ZW-96);:RETURN
1000DATA3,022,ADI,8,3,024,ANDI,8
1005DATA3,028,CMPI,8,4,03C0,CKOF,7
1010DATA4,03A0,CKON,7,4,0340,WAIT,7
1015DATA3,020,LDI,8,4,0300,LDIRQ,8
1020DATA4,03E0,CKEX,7,4,02E0,LDIWP,8
1025DATA3,026,ORI,8,4,0360,RST,7
1030DATA4,0380,RTNWP,7,2,0A,SLA,5
1035DATA2,08,SRA,5,2,0B,SRC,5
1040DATA2,09,SRL,5,3,02C,STST,8
1045DATA3,02A,STWP,8
1050DATA2,07,,10,2,06,,10
1055DATA2,05,,10,2,04,,10
1060DATA0,0,0,0
1100DATA2,13,JEQ,2,2,15,JGT,2
1105DATA2,1B,JH,2,2,14,JHE,2
1110DATA2,1A,JL,2,2,12,JLE,2
1115DATA2,11,JLT,2,2,10,BRA,2
1120DATA2,17,JNC,2,2,16,JNE,2
1125DATA2,19,JNO,2,2,18,JOC,2
1130DATA2,1C,JOP,2,2,1D,SETB,2
1135DATA2,1E,CLRB,2,2,1F,TEST,2
1140DATA0,0,0,0
1200DATA1,2,,40
1300DATA1,3,,41
1400DATA1,4,NOR,1
1500DATA1,5,NORB,1
1600DATA1,6,SB,1
1700DATA1,7,SBB,1
1800DATA1,8,CMP,1
1900DATA1,9,CMPB,1
2000DATA1,A,AD,1
2100DATA1,B,ADB,1
2200DATA1,C,MOV,1
2300DATA1,D,MOVB,1
2400DATA1,E,OR,1
2500DATA1,F,ORB,1
3400DATA4,JSWP,8,JMP,12,EXECUTE,16,CLR
3500DATA4,NEG2,8,NEG1,12,INC,16,INCT
3600DATA4,DEC,8,DECT,12,JSR,16,SWAP
3700DATA4,SET,8,ABS,0,0
4000DATACMPCO,3
4004DATACMPCZ,3
4008DATAEOR,3
4012DATAXOP,9
4100DATALDCRU,4
4104DATASTCRU,4
4108DATAMPY,9
4112DATADIV,9
4200DATA
4201DATA*
4202DATA$
4203DATA*+
5000GOSUB27:ZW=0:Z1$="":Z2$="":Z3$=""
5005GOSUB5900:IFMA=27THEN20
5006IFMA=0ORZW>2THENST=ST-2:GOTO5000
5010GOSUB5300:GOTO45
5300SET3400
5310FORR=0TO14:READA1,CO$:IFCO$<>Z1$THENNEXT:GOTO5320
5315XO=(INT(R/4)+4)*256+(A1-4)*16:F=6:A1=3:GOTO5350
5320FORR=0TO7:READCO$,F:IFCO$<>Z1$THENNEXT:SET1000:GOTO5330
5325XO=8192+R*1024:A1=2:GOTO5350
5330FORR=1TO55:READA1,A1$,CO$,F:IFCO$<>Z1$THENNEXT:GOTO6000
5340AS$=MID$(A1$+"000",1,4):GOSUB6020:GOTO5370
5350GOSUB6030
5370ONFGOTO6100,6200,6300,6400,6500,6600,6700,6800,6900
5900MA=CALL64768,0:IFMA=27THEN6010
5905IFMA=32ORMA=44THENZW=ZW+1:GOTO5930
5906IFMA=13ANDZ1$=""THENZW=3
5907IFMA=13THEN6010
5908IFMA<32ORMA>95THEN5900
5910IFZW=0THENZ1$=Z1$+CHR$(MA)
5915IFZW=1THENZ2$=Z2$+CHR$(MA)
5920IFZW=2THENZ3$=Z3$+CHR$(MA)
5925IFZW=3THENMA=0:GOTO6010
5930PRINTCHR$(MA);:GOTO5900
5950GOSUB27:Z2$="":Z3$="":ZW=1:Z1$=""
5955GOSUB5900:IFMA=27THEN20
5960IFMA=0ORZW<2THENST=ST-2:GOTO5950
5965AS$=Z2$+Z3$+"000":GOSUB2
5970ML=AS/256:MH=256*FRAC(ML):POKEST-1,MH:POKEST-2,ML
5975GOTO45
6000ER=1:ST=ST-2:RETURN
6010ER=1:PRINT:RETURN
6020GOSUB2:XO=AS
6030MH=INT(XO/256):ML=256*FRAC(XO/256):RETURN
6100REMFORMAT1
6101REM
6105F=0:IFZW<2THEN6000
6106GOSUB6115:IFERTHENRETURN
6107ML=ML+(SRAND15)+TS*16+(DRAND3)*64:MH=MH+(3ANDINT(DR/4))+TD*4
6108POKEST-2,MH:POKEST-1,ML
6109IFTS=2THENAS$=Z1$:GOSUB6020:POKEST,MH:POKEST+1,ML:ST=ST+2
6110IFTD=2THENAS$=ZW$:GOSUB6020:POKEST,MH:POKEST+1,ML:ST=ST+2
6113RETURN
6115FORZW=FTO1
6116ZW$=LEFT$(Z2$,1)
6118IFZW$="R"THENTD=0:DR=VAL(MID$(Z2$,2)):GOTO6160
6120GOSUB6990:IFT>3THEN6000
6125TD=T:IFT>1THENT=2:GOTO6145
6127IFT=0THENZW$="R":GOTO6118
6130T=2:IFMID$(Z2$,2,1)="+"THENTD=3:T=3
6135IFMID$(Z2$,T,1)<>"R"THEN6000
6140T=T+1
6145ZW$=MID$(Z2$,T):DR=0
6150IFT<>2THENDR=VAL(ZW$):GOTO6160
6155IFMID$(ZW$,5,1)<>"("THEN6160
6156IFMID$(ZW$,6,1)<>"R"THEN6000
6157DR=VAL(MID$(ZW$,7)):ZW$=LEFT$(ZW$,4)
6160IFZW=0THENZ2$=Z3$:SR=DR:TS=TD:Z1$=ZW$
6165NEXT:ER=0:RETURN
6200REMFORMAT2
6201REM
6205F=1:IFZW<>1THEN6000
6207IFMH>28THEN6250
6210GOSUB6115:IFERTHENRETURN
6215IFLEN(ZW$)<>4THEN6000
6220POKEST-2,MH:AS$=ZW$:GOSUB6020
6225D=(XO-ST)/2:IFD<>INT(D)THEN6000
6230IFD>127ORD<-128THEN6000
6235D=INT(D):IFD<0THEND=256+D
6240POKEST-1,D:RETURN
6250POKEST-2,MH:AS$=Z2$+"000":GOSUB6020:D=MH:GOTO6240
6300REMFORMAT3
6301REM
6305F=0:IFZW<2THEN6000
6310GOSUB6115:IFERTHENRETURN
6315IFTD<>0THEN6000
6320GOTO6107
6400REMFORMAT4
6401REM
6405GOTO6305
6500REMFORMAT5
6501REM
6505F=1:IFZW<2THEN6000
6510GOSUB6115:IFERTHENRETURN
6515IFTDTHEN6000
6520POKEST-2,MH:ML=VAL(Z3$):IFML<0ORML>15THEN6000
6525POKEST-1,DR+16*ML:RETURN
6600REMFORMAT6
6601REM
6605F=1:IFZW<>1THEN6000
6610GOSUB6115:IFERTHENRETURN
6615ML=ML+TD*16+DR:TS=0:GOTO6108
6700REMFORMAT7
6701REM
6705IFZW>0THEN6000
6710POKEST-2,MH:POKEST-1,ML:RETURN
6800REMFORMAT8
6801REM
6804IFXO>640THEN6850
6805F=0:IFZW<2THEN6000
6810GOSUB6115:IFERTHENRETURN
6815IFTSTHEN6000
6820ML=ML+SR:GOTO6108
6850F=1:IFZW<>FTHEN6000
6855GOSUB6115:IFERRTHENRETURN
6860SR=DR:TS=TD:IFXO<736THENTD=0:GOTO6815
6865IFTD<>2THEN6000
6870SR=0:TS=0:GOTO6815
6900REMFORMAT9
6901REM
6905GOTO6305
6989RETURN
6990SET6999:FORR=1TO4:READA1$,T:IFZW$<>A1$THENNEXT:T=4
6995RETURN
6999DATA*,1,$,2,C,0,#,2

